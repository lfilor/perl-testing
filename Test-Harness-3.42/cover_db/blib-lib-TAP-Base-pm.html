<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.36
Devel::Cover is copyright 2001-2019, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: blib/lib/TAP/Base.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">blib/lib/TAP/Base.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c2">95.9%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>pod</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">package TAP::Base;</td></tr>
<tr><td class="h">2</td><td colspan="7"></td></tr><tr><td class="h">3</td><td><div class="c3">44</div><div class="c3">44</div><div class="c3">44</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Base-pm--subroutine.html#L3">44</a></div></td><td></td><td><div>76556</div><div>33</div><div>667</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">4</td><td><div class="c3">44</div><div class="c3">44</div><div class="c3">44</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Base-pm--subroutine.html#L4">44</a></div></td><td></td><td><div>74</div><div>34</div><div>713</div></td><td class="s">use warnings;</td></tr>
<tr><td class="h">5</td><td colspan="7"></td></tr><tr><td class="h">6</td><td><div class="c3">44</div><div class="c3">44</div><div class="c3">44</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Base-pm--subroutine.html#L6">44</a></div></td><td></td><td><div>87</div><div>52</div><div>3862</div></td><td class="s">use base &#39;TAP::Object&#39;;</td></tr>
<tr><td class="h">7</td><td colspan="7"></td></tr><tr><td class="h">8 - 17</td><td colspan="6"></td><td class="s"><pre>=head1 NAME

TAP::Base - Base class that provides common functionality to L&lt;TAP::Parser&gt;
and L&lt;TAP::Harness&gt;

=head1 VERSION

Version 3.42

=cut</pre></td></tr>
<tr><td class="h">18</td><td colspan="7"></td></tr><tr><td class="h">19</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our $VERSION = &#39;3.42&#39;;</td></tr>
<tr><td class="h">20</td><td colspan="7"></td></tr><tr><td class="h">21</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">use constant GOT_TIME_HIRES =&gt; do {</td></tr>
<tr><td class="h">22</td><td><div class="c3">44</div><div class="c3">44</div><div class="c3">44</div><div class="c3">44</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Base-pm--subroutine.html#L22">44</a></div></td><td></td><td><div>1103</div><div>11741</div><div>23499</div><div>98</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;eval &#39;use Time::HiRes qw(time);&#39;;</td></tr>
<tr><td class="h">23</td><td><div class="c3">44</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Base-pm--branch.html#L23">50</a></div></td><td></td><td></td><td></td><td><div>15718</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$@ ? 0 : 1;</td></tr>
<tr><td class="h">24</td><td><div class="c3">44</div><div class="c3">44</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Base-pm--subroutine.html#L24">44</a></div></td><td></td><td><div>102</div><div>28</div></td><td class="s">};</td></tr>
<tr><td class="h">25</td><td colspan="7"></td></tr><tr><td class="h">26 - 48</td><td colspan="6"></td><td class="s"><pre>=head1 SYNOPSIS

&nbsp;&nbsp;&nbsp;&nbsp;package TAP::Whatever;

&nbsp;&nbsp;&nbsp;&nbsp;use base &#39;TAP::Base&#39;;

&nbsp;&nbsp;&nbsp;&nbsp;# ... later ...
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;my $thing = TAP::Whatever-&gt;new();
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;$thing-&gt;callback( event =&gt; sub {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# do something interesting
&nbsp;&nbsp;&nbsp;&nbsp;} );

=head1 DESCRIPTION

C&lt;TAP::Base&gt; provides callback management.

=head1 METHODS

=head2 Class Methods

=cut</pre></td></tr>
<tr><td class="h">49</td><td colspan="7"></td></tr><tr><td class="h">50</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _initialize {</td></tr>
<tr><td class="h">51</td><td><div class="c3">606</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Base-pm--subroutine.html#L51">606</a></div></td><td></td><td><div>974</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $arg_for, $ok_callback ) = @_;</td></tr>
<tr><td class="h">52</td><td colspan="7"></td></tr><tr><td class="h">53</td><td><div class="c3">606</div><div class="c3">3539</div></td><td></td><td></td><td></td><td></td><td><div>728</div><div>3715</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %ok_map = map { $_ =&gt; 1 } @$ok_callback;</td></tr>
<tr><td class="h">54</td><td colspan="7"></td></tr><tr><td class="h">55</td><td><div class="c3">606</div></td><td></td><td></td><td></td><td></td><td><div>1019</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{ok_callbacks} = \%ok_map;</td></tr>
<tr><td class="h">56</td><td colspan="7"></td></tr><tr><td class="h">57</td><td><div class="c3">606</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Base-pm--branch.html#L57">100</a></div></td><td></td><td></td><td></td><td><div>920</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( my $cb = delete $arg_for-&gt;{callbacks} ) {</td></tr>
<tr><td class="h">58</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ( my ( $event, $callback ) = each %$cb ) {</td></tr>
<tr><td class="h">59</td><td><div class="c3">11</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;callback( $event, $callback );</td></tr>
<tr><td class="h">60</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">61</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">62</td><td colspan="7"></td></tr><tr><td class="h">63</td><td><div class="c3">604</div></td><td></td><td></td><td></td><td></td><td><div>822</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self;</td></tr>
<tr><td class="h">64</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">65</td><td colspan="7"></td></tr><tr><td class="h">66 - 70</td><td colspan="6"></td><td class="s"><pre>=head3 C&lt;callback&gt;

Install a callback for a named event.

=cut</pre></td></tr>
<tr><td class="h">71</td><td colspan="7"></td></tr><tr><td class="h">72</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub callback {</td></tr>
<tr><td class="h">73</td><td><div class="c3">155</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Base-pm--subroutine.html#L73">155</a></div></td><td><div class="c3">1</div></td><td><div>4567</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $event, $callback ) = @_;</td></tr>
<tr><td class="h">74</td><td colspan="7"></td></tr><tr><td class="h">75</td><td><div class="c3">155</div><div class="c3">155</div></td><td></td><td></td><td></td><td></td><td><div>101</div><div>696</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %ok_map = %{ $self-&gt;{ok_callbacks} };</td></tr>
<tr><td class="h">76</td><td colspan="7"></td></tr><tr><td class="h">77</td><td><div class="c3">155</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Base-pm--branch.html#L77">100</a></div></td><td></td><td></td><td></td><td><div>190</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_croak(&#39;No callbacks may be installed&#39;)</td></tr>
<tr><td class="h">78</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless %ok_map;</td></tr>
<tr><td class="h">79</td><td colspan="7"></td></tr><tr><td class="h">80</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_croak( &quot;Callback $event is not supported. Valid callbacks are &quot;</td></tr>
<tr><td class="h">81</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. join( &#39;, &#39;, sort keys %ok_map ) )</td></tr>
<tr><td class="h">82</td><td><div class="c3">153</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Base-pm--branch.html#L82">100</a></div></td><td></td><td></td><td></td><td><div>177</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless exists $ok_map{$event};</td></tr>
<tr><td class="h">83</td><td colspan="7"></td></tr><tr><td class="h">84</td><td><div class="c3">150</div><div class="c3">150</div></td><td></td><td></td><td></td><td></td><td><div>107</div><div>239</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @{ $self-&gt;{code_for}{$event} }, $callback;</td></tr>
<tr><td class="h">85</td><td colspan="7"></td></tr><tr><td class="h">86</td><td><div class="c3">150</div></td><td></td><td></td><td></td><td></td><td><div>222</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">87</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">88</td><td colspan="7"></td></tr><tr><td class="h">89</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _has_callbacks {</td></tr>
<tr><td class="h">90</td><td><div class="c3">280</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Base-pm--subroutine.html#L90">280</a></div></td><td></td><td><div>197</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">91</td><td><div class="c3">280</div><div class="c3">280</div></td><td></td><td></td><td></td><td></td><td><div>267</div><div>915</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return keys %{ $self-&gt;{code_for} } != 0;</td></tr>
<tr><td class="h">92</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">93</td><td colspan="7"></td></tr><tr><td class="h">94</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _callback_for {</td></tr>
<tr><td class="h">95</td><td><div class="c3">1244</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Base-pm--subroutine.html#L95">1244</a></div></td><td></td><td><div>4062</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $event ) = @_;</td></tr>
<tr><td class="h">96</td><td><div class="c3">1244</div></td><td></td><td></td><td></td><td></td><td><div>1381</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;{code_for}{$event};</td></tr>
<tr><td class="h">97</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">98</td><td colspan="7"></td></tr><tr><td class="h">99</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _make_callback {</td></tr>
<tr><td class="h">100</td><td><div class="c3">960</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Base-pm--subroutine.html#L100">960</a></div></td><td></td><td><div>1737</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self&nbsp;&nbsp;= shift;</td></tr>
<tr><td class="h">101</td><td><div class="c3">960</div></td><td></td><td></td><td></td><td></td><td><div>966</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $event = shift;</td></tr>
<tr><td class="h">102</td><td colspan="7"></td></tr><tr><td class="h">103</td><td><div class="c3">960</div></td><td></td><td></td><td></td><td></td><td><div>862</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $cb = $self-&gt;_callback_for($event);</td></tr>
<tr><td class="h">104</td><td><div class="c3">960</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Base-pm--branch.html#L104">100</a></div></td><td></td><td></td><td></td><td><div>972</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless defined $cb;</td></tr>
<tr><td class="h">105</td><td><div class="c3">150</div><div class="c3">151</div></td><td></td><td></td><td></td><td></td><td><div>149</div><div>276</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return map { $_-&gt;(@_) } @$cb;</td></tr>
<tr><td class="h">106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">107</td><td colspan="7"></td></tr><tr><td class="h">108 - 112</td><td colspan="6"></td><td class="s"><pre>=head3 C&lt;get_time&gt;

Return the current time using Time::HiRes if available.

=cut</pre></td></tr>
<tr><td class="h">113</td><td colspan="7"></td></tr><tr><td class="h">114</td><td><div class="c3">625</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Base-pm--subroutine.html#L114">625</a></div></td><td><div class="c3">1</div></td><td><div>6054</div></td><td class="s">sub get_time { return time() }</td></tr>
<tr><td class="h">115</td><td colspan="7"></td></tr><tr><td class="h">116 - 120</td><td colspan="6"></td><td class="s"><pre>=head3 C&lt;time_is_hires&gt;

Return true if the time returned by get_time is high resolution (i.e. if Time::HiRes is available).

=cut</pre></td></tr>
<tr><td class="h">121</td><td colspan="7"></td></tr><tr><td class="h">122</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-TAP-Base-pm--subroutine.html#L122">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">sub time_is_hires { return GOT_TIME_HIRES }</td></tr>
<tr><td class="h">123</td><td colspan="7"></td></tr><tr><td class="h">124 - 129</td><td colspan="6"></td><td class="s"><pre>=head3 C&lt;get_times&gt;

Return array reference of the four-element list of CPU seconds,
as with L&lt;perlfunc/times&gt;.

=cut</pre></td></tr>
<tr><td class="h">130</td><td colspan="7"></td></tr><tr><td class="h">131</td><td><div class="c3">551</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Base-pm--subroutine.html#L131">551</a></div></td><td><div class="c3">1</div></td><td><div>1987</div></td><td class="s">sub get_times { return [ times() ] }</td></tr>
<tr><td class="h">132</td><td colspan="7"></td></tr><tr><td class="h">133</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
</table>
</body>
</html>
