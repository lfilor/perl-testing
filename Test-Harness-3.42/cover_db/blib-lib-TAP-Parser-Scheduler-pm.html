<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.36
Devel::Cover is copyright 2001-2019, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: blib/lib/TAP/Parser/Scheduler.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">blib/lib/TAP/Parser/Scheduler.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c1">86.9%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>pod</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">package TAP::Parser::Scheduler;</td></tr>
<tr><td class="h">2</td><td colspan="7"></td></tr><tr><td class="h">3</td><td><div class="c3">16</div><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L3">16</a></div></td><td></td><td><div>166348</div><div>11</div><div>222</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">4</td><td><div class="c3">16</div><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L4">16</a></div></td><td></td><td><div>26</div><div>11</div><div>229</div></td><td class="s">use warnings;</td></tr>
<tr><td class="h">5</td><td colspan="7"></td></tr><tr><td class="h">6</td><td><div class="c3">16</div><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L6">16</a></div></td><td></td><td><div>28</div><div>12</div><div>387</div></td><td class="s">use Carp;</td></tr>
<tr><td class="h">7</td><td><div class="c3">16</div><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L7">16</a></div></td><td></td><td><div>2475</div><div>13</div><div>230</div></td><td class="s">use TAP::Parser::Scheduler::Job;</td></tr>
<tr><td class="h">8</td><td><div class="c3">16</div><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L8">16</a></div></td><td></td><td><div>3374</div><div>12</div><div>10617</div></td><td class="s">use TAP::Parser::Scheduler::Spinner;</td></tr>
<tr><td class="h">9</td><td colspan="7"></td></tr><tr><td class="h">10 - 18</td><td colspan="6"></td><td class="s"><pre>=head1 NAME

TAP::Parser::Scheduler - Schedule tests during parallel testing

=head1 VERSION

Version 3.42

=cut</pre></td></tr>
<tr><td class="h">19</td><td colspan="7"></td></tr><tr><td class="h">20</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our $VERSION = &#39;3.42&#39;;</td></tr>
<tr><td class="h">21</td><td colspan="7"></td></tr><tr><td class="h">22 - 127</td><td colspan="6"></td><td class="s"><pre>=head1 SYNOPSIS

&nbsp;&nbsp;&nbsp;&nbsp;use TAP::Parser::Scheduler;

=head1 DESCRIPTION

=head1 METHODS

=head2 Class Methods

=head3 C&lt;new&gt;

&nbsp;&nbsp;&nbsp;&nbsp;my $sched = TAP::Parser::Scheduler-&gt;new(tests =&gt; \@tests);
&nbsp;&nbsp;&nbsp;&nbsp;my $sched = TAP::Parser::Scheduler-&gt;new(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tests =&gt; [ [&#39;t/test_name.t&#39;,&#39;Test Description&#39;], ... ],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules =&gt; \%rules,
&nbsp;&nbsp;&nbsp;&nbsp;);

Given &#39;tests&#39; and optional &#39;rules&#39; as input, returns a new
C&lt;TAP::Parser::Scheduler&gt; object.&nbsp;&nbsp;Each member of C&lt;@tests&gt; should be either a
a test file name, or a two element arrayref, where the first element is a test
file name, and the second element is a test description. By default, we&#39;ll use
the test name as the description.

The optional C&lt;rules&gt; attribute provides direction on which tests should be run
in parallel and which should be run sequentially. If no rule data structure is
provided, a default data structure is used which makes every test eligible to
be run in parallel:

&nbsp;&nbsp;&nbsp;&nbsp;{ par =&gt; &#39;**&#39; },

The rules data structure is documented more in the next section.

=head2 Rules data structure

The &quot;C&lt;rules&gt;&quot; data structure is the the heart of the scheduler. It allows you
to express simple rules like &quot;run all tests in sequence&quot; or &quot;run all tests in
parallel except these five tests.&quot;. However, the rules structure also supports
glob-style pattern matching and recursive definitions, so you can also express
arbitarily complicated patterns.

The rule must only have one top level key: either &#39;par&#39; for &quot;parallel&quot; or &#39;seq&#39;
for &quot;sequence&quot;.

Values must be either strings with possible glob-style matching, or arrayrefs
of strings or hashrefs which follow this pattern recursively.

Every element in an arrayref directly below a &#39;par&#39; key is eligible to be run
in parallel, while vavalues directly below a &#39;seq&#39; key must be run in sequence.

=head3 Rules examples

Here are some examples:

&nbsp;&nbsp;&nbsp;&nbsp;# All tests be run in parallel (the default rule)
&nbsp;&nbsp;&nbsp;&nbsp;{ par =&gt; &#39;**&#39; },

&nbsp;&nbsp;&nbsp;&nbsp;# Run all tests in sequence, except those starting with &quot;p&quot;
&nbsp;&nbsp;&nbsp;&nbsp;{ par =&gt; &#39;t/p*.t&#39; },

&nbsp;&nbsp;&nbsp;&nbsp;# Run all tests in parallel, except those starting with &quot;p&quot;
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq =&gt; [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ seq =&gt; &#39;t/p*.t&#39; },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ par =&gt; &#39;**&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],
&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;# Run some&nbsp;&nbsp;startup tests in sequence, then some parallel tests then some
&nbsp;&nbsp;&nbsp;&nbsp;# teardown tests in sequence.
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq =&gt; [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ seq =&gt; &#39;t/startup/*.t&#39; },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ par =&gt; [&#39;t/a/*.t&#39;,&#39;t/b/*.t&#39;,&#39;t/c/*.t&#39;], }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ seq =&gt; &#39;t/shutdown/*.t&#39; },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],
&nbsp;&nbsp;&nbsp;&nbsp;},


=head3 Rules resolution

=over 4

=item * By default, all tests are eligible to be run in parallel. Specifying any of your own rules removes this one.

=item * &quot;First match wins&quot;. The first rule that matches a test will be the one that applies.

=item * Any test which does not match a rule will be run in sequence at the end of the run.

=item * The existence of a rule does not imply selecting a test. You must still specify the tests to run.

=item * Specifying a rule to allow tests to run in parallel does not make the run in parallel. You still need specify the number of parallel C&lt;jobs&gt; in your Harness object.

=back

=head3 Glob-style pattern matching for rules

We implement our own glob-style pattern matching. Here are the patterns it supports:

&nbsp;&nbsp;&nbsp;&nbsp;** is any number of characters, including /, within a pathname
&nbsp;&nbsp;&nbsp;&nbsp;* is zero or more characters within a filename/directory name
&nbsp;&nbsp;&nbsp;&nbsp;? is exactly one character within a filename/directory name
&nbsp;&nbsp;&nbsp;&nbsp;{foo,bar,baz} is any of foo, bar or baz.
&nbsp;&nbsp;&nbsp;&nbsp;\ is an escape character

=cut</pre></td></tr>
<tr><td class="h">128</td><td colspan="7"></td></tr><tr><td class="h">129</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub new {</td></tr>
<tr><td class="h">130</td><td><div class="c3">89</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L130">89</a></div></td><td><div class="c3">1</div></td><td><div>46583</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $class = shift;</td></tr>
<tr><td class="h">131</td><td colspan="7"></td></tr><tr><td class="h">132</td><td><div class="c3">89</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L132">50</a></div></td><td></td><td></td><td></td><td><div>129</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;croak &quot;Need a number of key, value pairs&quot; if @_ % 2;</td></tr>
<tr><td class="h">133</td><td colspan="7"></td></tr><tr><td class="h">134</td><td><div class="c3">89</div></td><td></td><td></td><td></td><td></td><td><div>216</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %args&nbsp;&nbsp;= @_;</td></tr>
<tr><td class="h">135</td><td><div class="c3">89</div></td><td></td><td><div class="c0"><a href="blib-lib-TAP-Parser-Scheduler-pm--condition.html#L135">33</a></div></td><td></td><td></td><td><div>198</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $tests = delete $args{tests} || croak &quot;Need a &#39;tests&#39; argument&quot;;</td></tr>
<tr><td class="h">136</td><td><div class="c3">89</div></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--condition.html#L136">100</a></div></td><td></td><td></td><td><div>392</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $rules = delete $args{rules} || { par =&gt; &#39;**&#39; };</td></tr>
<tr><td class="h">137</td><td colspan="7"></td></tr><tr><td class="h">138</td><td><div class="c3">89</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L138">50</a></div></td><td></td><td></td><td></td><td><div>121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;croak &quot;Unknown arg(s): &quot;, join &#39;, &#39;, sort keys %args</td></tr>
<tr><td class="h">139</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if keys %args;</td></tr>
<tr><td class="h">140</td><td colspan="7"></td></tr><tr><td class="h">141</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Turn any simple names into a name, description pair. TODO: Maybe</td></tr>
<tr><td class="h">142</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# construct jobs here?</td></tr>
<tr><td class="h">143</td><td><div class="c3">89</div></td><td></td><td></td><td></td><td></td><td><div>89</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = bless {}, $class;</td></tr>
<tr><td class="h">144</td><td colspan="7"></td></tr><tr><td class="h">145</td><td><div class="c3">89</div></td><td></td><td></td><td></td><td></td><td><div>122</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_set_rules( $rules, $tests );</td></tr>
<tr><td class="h">146</td><td colspan="7"></td></tr><tr><td class="h">147</td><td><div class="c3">89</div></td><td></td><td></td><td></td><td></td><td><div>237</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self;</td></tr>
<tr><td class="h">148</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">149</td><td colspan="7"></td></tr><tr><td class="h">150</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Build the scheduler data structure.</td></tr>
<tr><td class="h">151</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">152</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># SCHEDULER-DATA ::= JOB</td></tr>
<tr><td class="h">153</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||&nbsp;&nbsp;ARRAY OF ARRAY OF SCHEDULER-DATA</td></tr>
<tr><td class="h">154</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">155</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># The nested arrays are the key to scheduling. The outer array contains</td></tr>
<tr><td class="h">156</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># a list of things that may be executed in parallel. Whenever an</td></tr>
<tr><td class="h">157</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># eligible job is sought any element of the outer array that is ready to</td></tr>
<tr><td class="h">158</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># execute can be selected. The inner arrays represent sequential</td></tr>
<tr><td class="h">159</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># execution. They can only proceed when the first job is ready to run.</td></tr>
<tr><td class="h">160</td><td colspan="7"></td></tr><tr><td class="h">161</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _set_rules {</td></tr>
<tr><td class="h">162</td><td><div class="c3">89</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L162">89</a></div></td><td></td><td><div>95</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $rules, $tests ) = @_;</td></tr>
<tr><td class="h">163</td><td colspan="7"></td></tr><tr><td class="h">164</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Convert all incoming tests to job objects. </td></tr>
<tr><td class="h">165</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# If no test description is provided use the file name as the description. </td></tr>
<tr><td class="h">166</td><td><div class="c3">448</div></td><td></td><td></td><td></td><td></td><td><div>553</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @tests = map { TAP::Parser::Scheduler::Job-&gt;new(@$_) }</td></tr>
<tr><td class="h">167</td><td><div class="c3">89</div><div class="c3">448</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L167">100</a></div></td><td></td><td></td><td></td><td><div>85</div><div>501</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { &#39;ARRAY&#39; eq ref $_ ? $_ : [ $_, $_ ] } @$tests;</td></tr>
<tr><td class="h">168</td><td><div class="c3">89</div></td><td></td><td></td><td></td><td></td><td><div>169</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $schedule = $self-&gt;_rule_clause( $rules, \@tests );</td></tr>
<tr><td class="h">169</td><td colspan="7"></td></tr><tr><td class="h">170</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# If any tests are left add them as a sequential block at the end of</td></tr>
<tr><td class="h">171</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# the run.</td></tr>
<tr><td class="h">172</td><td><div class="c3">89</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L172">100</a></div></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$schedule = [ [ $schedule, @tests ] ] if @tests;</td></tr>
<tr><td class="h">173</td><td colspan="7"></td></tr><tr><td class="h">174</td><td><div class="c3">89</div></td><td></td><td></td><td></td><td></td><td><div>114</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{schedule} = $schedule;</td></tr>
<tr><td class="h">175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">176</td><td colspan="7"></td></tr><tr><td class="h">177</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _rule_clause {</td></tr>
<tr><td class="h">178</td><td><div class="c3">139</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L178">139</a></div></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $rule, $tests ) = @_;</td></tr>
<tr><td class="h">179</td><td><div class="c3">139</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L179">50</a></div></td><td></td><td></td><td></td><td><div>188</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;croak &#39;Rule clause must be a hash&#39;</td></tr>
<tr><td class="h">180</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless &#39;HASH&#39; eq ref $rule;</td></tr>
<tr><td class="h">181</td><td colspan="7"></td></tr><tr><td class="h">182</td><td><div class="c3">139</div></td><td></td><td></td><td></td><td></td><td><div>206</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @type = keys %$rule;</td></tr>
<tr><td class="h">183</td><td><div class="c3">139</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L183">50</a></div></td><td></td><td></td><td></td><td><div>185</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;croak &#39;Rule clause must have exactly one key&#39;</td></tr>
<tr><td class="h">184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless @type == 1;</td></tr>
<tr><td class="h">185</td><td colspan="7"></td></tr><tr><td class="h">186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %handlers = (</td></tr>
<tr><td class="h">187</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par =&gt; sub {</td></tr>
<tr><td class="h">188</td><td><div class="c3">93</div><div class="c3">190</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L188">93</a></div></td><td></td><td><div>89</div><div>378</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ map { [$_] } @_ ];</td></tr>
<tr><td class="h">189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">190</td><td><div class="c3">46</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L190">46</a></div></td><td></td><td><div>117</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq =&gt; sub { [ [@_] ] },</td></tr>
<tr><td class="h">191</td><td><div class="c3">139</div></td><td></td><td></td><td></td><td></td><td><div>529</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">192</td><td colspan="7"></td></tr><tr><td class="h">193</td><td><div class="c3">139</div></td><td></td><td><div class="c0"><a href="blib-lib-TAP-Parser-Scheduler-pm--condition.html#L193">33</a></div></td><td></td><td></td><td><div>241</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $handler = $handlers{ $type[0] }</td></tr>
<tr><td class="h">194</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| croak &#39;Unknown scheduler type: &#39;, $type[0];</td></tr>
<tr><td class="h">195</td><td><div class="c3">139</div></td><td></td><td></td><td></td><td></td><td><div>123</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $val = $rule-&gt;{ $type[0] };</td></tr>
<tr><td class="h">196</td><td colspan="7"></td></tr><tr><td class="h">197</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $handler-&gt;(</td></tr>
<tr><td class="h">198</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map {</td></tr>
<tr><td class="h">199</td><td><div class="c3">139</div><div class="c3">190</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L199">100</a></div><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L199">100</a></div></td><td></td><td></td><td></td><td><div>183</div><div>232</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;HASH&#39; eq ref $_</td></tr>
<tr><td class="h">200</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $self-&gt;_rule_clause( $_, $tests )</td></tr>
<tr><td class="h">201</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: $self-&gt;_expand( $_, $tests )</td></tr>
<tr><td class="h">202</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &#39;ARRAY&#39; eq ref $val ? @$val : $val</td></tr>
<tr><td class="h">203</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">204</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">205</td><td colspan="7"></td></tr><tr><td class="h">206</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _glob_to_regexp {</td></tr>
<tr><td class="h">207</td><td><div class="c3">160</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L207">160</a></div></td><td></td><td><div>5857</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $glob ) = @_;</td></tr>
<tr><td class="h">208</td><td><div class="c3">160</div></td><td></td><td></td><td></td><td></td><td><div>145</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $nesting;</td></tr>
<tr><td class="h">209</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $pattern;</td></tr>
<tr><td class="h">210</td><td colspan="7"></td></tr><tr><td class="h">211</td><td><div class="c3">160</div></td><td></td><td></td><td></td><td></td><td><div>102</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (1) {</td></tr>
<tr><td class="h">212</td><td><div class="c3">318</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L212">100</a></div><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L212">100</a></div><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L212">100</a></div><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L212">100</a></div><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L212">100</a></div><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L212">100</a></div><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L212">100</a></div><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L212">100</a></div></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--condition.html#L212">100</a></div><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--condition.html#L212">100</a></div></td><td></td><td></td><td><div>767</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $glob =~ /\G\*\*/gc ) {</td></tr>
<tr><td class="h">213</td><td colspan="7"></td></tr><tr><td class="h">214</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ** is any number of characters, including /, within a pathname</td></tr>
<tr><td class="h">215</td><td><div class="c3">82</div></td><td></td><td></td><td></td><td></td><td><div>101</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pattern .= &#39;.*?&#39;;</td></tr>
<tr><td class="h">216</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">217</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ( $glob =~ /\G\*/gc ) {</td></tr>
<tr><td class="h">218</td><td colspan="7"></td></tr><tr><td class="h">219</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# * is zero or more characters within a filename/directory name</td></tr>
<tr><td class="h">220</td><td><div class="c3">54</div></td><td></td><td></td><td></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pattern .= &#39;[^/]*&#39;;</td></tr>
<tr><td class="h">221</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">222</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ( $glob =~ /\G\?/gc ) {</td></tr>
<tr><td class="h">223</td><td colspan="7"></td></tr><tr><td class="h">224</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# ? is exactly one character within a filename/directory name</td></tr>
<tr><td class="h">225</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pattern .= &#39;[^/]&#39;;</td></tr>
<tr><td class="h">226</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">227</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ( $glob =~ /\G\{/gc ) {</td></tr>
<tr><td class="h">228</td><td colspan="7"></td></tr><tr><td class="h">229</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# {foo,bar,baz} is any of foo, bar or baz.</td></tr>
<tr><td class="h">230</td><td><div class="c3">15</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pattern .= &#39;(?:&#39;;</td></tr>
<tr><td class="h">231</td><td><div class="c3">15</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++$nesting;</td></tr>
<tr><td class="h">232</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">233</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ( $nesting and $glob =~ /\G,/gc ) {</td></tr>
<tr><td class="h">234</td><td colspan="7"></td></tr><tr><td class="h">235</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# , is only special inside {}</td></tr>
<tr><td class="h">236</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pattern .= &#39;|&#39;;</td></tr>
<tr><td class="h">237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">238</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ( $nesting and $glob =~ /\G\}/gc ) {</td></tr>
<tr><td class="h">239</td><td colspan="7"></td></tr><tr><td class="h">240</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# } that matches { is special. But unbalanced } are not.</td></tr>
<tr><td class="h">241</td><td><div class="c3">15</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pattern .= &#39;)&#39;;</td></tr>
<tr><td class="h">242</td><td><div class="c3">15</div></td><td></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--$nesting;</td></tr>
<tr><td class="h">243</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">244</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ( $glob =~ /\G(\\.)/gc ) {</td></tr>
<tr><td class="h">245</td><td colspan="7"></td></tr><tr><td class="h">246</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# A quoted literal</td></tr>
<tr><td class="h">247</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pattern .= $1;</td></tr>
<tr><td class="h">248</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">249</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ( $glob =~ /\G([\},])/gc ) {</td></tr>
<tr><td class="h">250</td><td colspan="7"></td></tr><tr><td class="h">251</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Sometimes meta characters</td></tr>
<tr><td class="h">252</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pattern .= &#39;\\&#39; . $1;</td></tr>
<tr><td class="h">253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">254</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">255</td><td colspan="7"></td></tr><tr><td class="h">256</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Eat everything that is not a meta character.</td></tr>
<tr><td class="h">257</td><td><div class="c3">122</div></td><td></td><td></td><td></td><td></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$glob =~ /\G([^{?*\\\},]*)/gc;</td></tr>
<tr><td class="h">258</td><td><div class="c3">122</div></td><td></td><td></td><td></td><td></td><td><div>113</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pattern .= quotemeta $1;</td></tr>
<tr><td class="h">259</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">260</td><td><div class="c3">318</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L260">100</a></div></td><td></td><td></td><td></td><td><div>503</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $pattern if pos $glob == length $glob;</td></tr>
<tr><td class="h">261</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">263</td><td colspan="7"></td></tr><tr><td class="h">264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _expand {</td></tr>
<tr><td class="h">265</td><td><div class="c3">140</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L265">140</a></div></td><td></td><td><div>126</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $name, $tests ) = @_;</td></tr>
<tr><td class="h">266</td><td colspan="7"></td></tr><tr><td class="h">267</td><td><div class="c3">140</div></td><td></td><td></td><td></td><td></td><td><div>134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $pattern = $self-&gt;_glob_to_regexp($name);</td></tr>
<tr><td class="h">268</td><td><div class="c3">140</div></td><td></td><td></td><td></td><td></td><td><div>709</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$pattern = qr/^ $pattern $/x;</td></tr>
<tr><td class="h">269</td><td><div class="c3">140</div></td><td></td><td></td><td></td><td></td><td><div>158</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @match = ();</td></tr>
<tr><td class="h">270</td><td colspan="7"></td></tr><tr><td class="h">271</td><td><div class="c3">140</div></td><td></td><td></td><td></td><td></td><td><div>165</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for ( my $ti = 0; $ti &lt; @$tests; $ti++ ) {</td></tr>
<tr><td class="h">272</td><td><div class="c3">3567</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L272">100</a></div></td><td></td><td></td><td></td><td><div>6664</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $tests-&gt;[$ti]-&gt;filename =~ $pattern ) {</td></tr>
<tr><td class="h">273</td><td><div class="c3">414</div></td><td></td><td></td><td></td><td></td><td><div>335</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @match, splice @$tests, $ti, 1;</td></tr>
<tr><td class="h">274</td><td><div class="c3">414</div></td><td></td><td></td><td></td><td></td><td><div>353</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ti--;</td></tr>
<tr><td class="h">275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">276</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">277</td><td colspan="7"></td></tr><tr><td class="h">278</td><td><div class="c3">140</div></td><td></td><td></td><td></td><td></td><td><div>246</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return @match;</td></tr>
<tr><td class="h">279</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">280</td><td colspan="7"></td></tr><tr><td class="h">281 - 287</td><td colspan="6"></td><td class="s"><pre>=head2 Instance Methods

=head3 C&lt;get_all&gt;

Get a list of all remaining tests.

=cut</pre></td></tr>
<tr><td class="h">288</td><td colspan="7"></td></tr><tr><td class="h">289</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_all {</td></tr>
<tr><td class="h">290</td><td><div class="c3">181</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L290">181</a></div></td><td><div class="c3">1</div></td><td><div>142</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">291</td><td><div class="c3">181</div></td><td></td><td></td><td></td><td></td><td><div>279</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @all&nbsp;&nbsp;= $self-&gt;_gather( $self-&gt;{schedule} );</td></tr>
<tr><td class="h">292</td><td><div class="c3">181</div></td><td></td><td></td><td></td><td></td><td><div>182</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{count} = @all;</td></tr>
<tr><td class="h">293</td><td><div class="c3">181</div></td><td></td><td></td><td></td><td></td><td><div>267</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@all;</td></tr>
<tr><td class="h">294</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">295</td><td colspan="7"></td></tr><tr><td class="h">296</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _gather {</td></tr>
<tr><td class="h">297</td><td><div class="c3">712</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L297">712</a></div></td><td></td><td><div>452</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $rule ) = @_;</td></tr>
<tr><td class="h">298</td><td><div class="c3">712</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L298">50</a></div></td><td></td><td></td><td></td><td><div>531</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless defined $rule;</td></tr>
<tr><td class="h">299</td><td><div class="c3">712</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L299">100</a></div></td><td></td><td></td><td></td><td><div>750</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $rule unless &#39;ARRAY&#39; eq ref $rule;</td></tr>
<tr><td class="h">300</td><td><div class="c3">264</div><div class="c3">581</div><div class="c3">396</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L300">100</a></div></td><td></td><td></td><td></td><td><div>244</div><div>573</div><div>417</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return map { defined() ? $self-&gt;_gather($_) : () } map {@$_} @$rule;</td></tr>
<tr><td class="h">301</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">302</td><td colspan="7"></td></tr><tr><td class="h">303 - 309</td><td colspan="6"></td><td class="s"><pre>=head3 C&lt;get_job&gt;

Return the next available job as L&lt;TAP::Parser::Scheduler::Job&gt; object or
C&lt;undef&gt; if none are available. Returns a L&lt;TAP::Parser::Scheduler::Spinner&gt; if
the scheduler still has pending jobs but none are available to run right now.

=cut</pre></td></tr>
<tr><td class="h">310</td><td colspan="7"></td></tr><tr><td class="h">311</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_job {</td></tr>
<tr><td class="h">312</td><td><div class="c3">601</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L312">601</a></div></td><td><div class="c3">1</div></td><td><div>78826</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">313</td><td><div class="c3">601</div></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--condition.html#L313">100</a></div></td><td></td><td></td><td><div>988</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{count} ||= $self-&gt;get_all;</td></tr>
<tr><td class="h">314</td><td><div class="c3">601</div></td><td></td><td></td><td></td><td></td><td><div>682</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @jobs = $self-&gt;_find_next_job( $self-&gt;{schedule} );</td></tr>
<tr><td class="h">315</td><td><div class="c3">601</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L315">100</a></div></td><td></td><td></td><td></td><td><div>623</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (@jobs) {</td></tr>
<tr><td class="h">316</td><td><div class="c3">448</div></td><td></td><td></td><td></td><td></td><td><div>335</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--$self-&gt;{count};</td></tr>
<tr><td class="h">317</td><td><div class="c3">448</div></td><td></td><td></td><td></td><td></td><td><div>526</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $jobs[0];</td></tr>
<tr><td class="h">318</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">319</td><td colspan="7"></td></tr><tr><td class="h">320</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return TAP::Parser::Scheduler::Spinner-&gt;new</td></tr>
<tr><td class="h">321</td><td><div class="c3">153</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L321">100</a></div></td><td></td><td></td><td></td><td><div>217</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $self-&gt;{count};</td></tr>
<tr><td class="h">322</td><td colspan="7"></td></tr><tr><td class="h">323</td><td><div class="c3">92</div></td><td></td><td></td><td></td><td></td><td><div>130</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">324</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">325</td><td colspan="7"></td></tr><tr><td class="h">326</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _not_empty {</td></tr>
<tr><td class="h">327</td><td><div class="c3">23666</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L327">23666</a></div></td><td></td><td><div>14545</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ar = shift;</td></tr>
<tr><td class="h">328</td><td><div class="c3">23666</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L328">100</a></div></td><td></td><td></td><td></td><td><div>30965</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 unless &#39;ARRAY&#39; eq ref $ar;</td></tr>
<tr><td class="h">329</td><td><div class="c3">13293</div></td><td></td><td></td><td></td><td></td><td><div>10290</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for (@$ar) {</td></tr>
<tr><td class="h">330</td><td><div class="c3">13276</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L330">100</a></div></td><td></td><td></td><td></td><td><div>9124</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1 if _not_empty($_);</td></tr>
<tr><td class="h">331</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">332</td><td><div class="c3">67</div></td><td></td><td></td><td></td><td></td><td><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">333</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">334</td><td colspan="7"></td></tr><tr><td class="h">335</td><td><div class="c3">10390</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L335">10390</a></div></td><td></td><td><div>7068</div></td><td class="s">sub _is_empty { !_not_empty(@_) }</td></tr>
<tr><td class="h">336</td><td colspan="7"></td></tr><tr><td class="h">337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _find_next_job {</td></tr>
<tr><td class="h">338</td><td><div class="c3">4167</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L338">4167</a></div></td><td></td><td><div>2820</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $rule ) = @_;</td></tr>
<tr><td class="h">339</td><td colspan="7"></td></tr><tr><td class="h">340</td><td><div class="c3">4167</div></td><td></td><td></td><td></td><td></td><td><div>2851</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @queue = ();</td></tr>
<tr><td class="h">341</td><td><div class="c3">4167</div></td><td></td><td></td><td></td><td></td><td><div>2412</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $index = 0;</td></tr>
<tr><td class="h">342</td><td><div class="c3">4167</div></td><td></td><td></td><td></td><td></td><td><div>3370</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while ( $index &lt; @$rule ) {</td></tr>
<tr><td class="h">343</td><td><div class="c3">10508</div></td><td></td><td></td><td></td><td></td><td><div>6503</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $seq = $rule-&gt;[$index];</td></tr>
<tr><td class="h">344</td><td colspan="7"></td></tr><tr><td class="h">345</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Prune any exhausted items.</td></tr>
<tr><td class="h">346</td><td><div class="c3">10508</div></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--condition.html#L346">100</a></div></td><td></td><td></td><td><div>11497</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift @$seq while @$seq &amp;&amp; _is_empty( $seq-&gt;[0] );</td></tr>
<tr><td class="h">347</td><td><div class="c3">10508</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L347">100</a></div></td><td></td><td></td><td></td><td><div>9204</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@$seq) {</td></tr>
<tr><td class="h">348</td><td><div class="c3">10373</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L348">100</a></div></td><td></td><td></td><td></td><td><div>8437</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( defined $seq-&gt;[0] ) {</td></tr>
<tr><td class="h">349</td><td><div class="c3">6991</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L349">100</a></div></td><td></td><td></td><td></td><td><div>5573</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( &#39;ARRAY&#39; eq ref $seq-&gt;[0] ) {</td></tr>
<tr><td class="h">350</td><td><div class="c3">6543</div></td><td></td><td></td><td></td><td></td><td><div>4485</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @queue, $seq;</td></tr>
<tr><td class="h">351</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">352</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">353</td><td><div class="c3">448</div></td><td></td><td></td><td></td><td></td><td><div>451</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $job = splice @$seq, 0, 1, undef;</td></tr>
<tr><td class="h">354</td><td><div class="c3">448</div><div class="c3">427</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L354">427</a></div></td><td></td><td><div>1174</div><div>1407</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$job-&gt;on_finish( sub { shift @$seq } );</td></tr>
<tr><td class="h">355</td><td><div class="c3">448</div></td><td></td><td></td><td></td><td></td><td><div>637</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $job;</td></tr>
<tr><td class="h">356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">357</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">358</td><td><div class="c3">9925</div></td><td></td><td></td><td></td><td></td><td><div>8775</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++$index;</td></tr>
<tr><td class="h">359</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">360</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">361</td><td colspan="7"></td></tr><tr><td class="h">362</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Remove the empty sub-array from the array</td></tr>
<tr><td class="h">363</td><td><div class="c3">135</div></td><td></td><td></td><td></td><td></td><td><div>229</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;splice @$rule, $index, 1;</td></tr>
<tr><td class="h">364</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">365</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">366</td><td colspan="7"></td></tr><tr><td class="h">367</td><td><div class="c3">3719</div></td><td></td><td></td><td></td><td></td><td><div>2590</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $seq (@queue) {</td></tr>
<tr><td class="h">368</td><td><div class="c3">3566</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L368">100</a></div></td><td></td><td></td><td></td><td><div>2765</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( my @jobs = $self-&gt;_find_next_job( $seq-&gt;[0] ) ) {</td></tr>
<tr><td class="h">369</td><td><div class="c3">309</div></td><td></td><td></td><td></td><td></td><td><div>547</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return @jobs;</td></tr>
<tr><td class="h">370</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">371</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">372</td><td colspan="7"></td></tr><tr><td class="h">373</td><td><div class="c3">3410</div></td><td></td><td></td><td></td><td></td><td><div>3737</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">374</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">375</td><td colspan="7"></td></tr><tr><td class="h">376 - 420</td><td colspan="6"></td><td class="s"><pre>=head3 C&lt;as_string&gt;

Return a human readable representation of the scheduling tree.
For example:

&nbsp;&nbsp;&nbsp;&nbsp;my @tests = (qw{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t/startup/foo.t 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t/shutdown/foo.t
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t/a/foo.t t/b/foo.t t/c/foo.t t/d/foo.t
&nbsp;&nbsp;&nbsp;&nbsp;});
&nbsp;&nbsp;&nbsp;&nbsp;my $sched = TAP::Parser::Scheduler-&gt;new(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tests =&gt; \@tests,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules =&gt; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq =&gt; [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ seq =&gt; &#39;t/startup/*.t&#39; },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ par =&gt; [&#39;t/a/*.t&#39;,&#39;t/b/*.t&#39;,&#39;t/c/*.t&#39;] },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ seq =&gt; &#39;t/shutdown/*.t&#39; },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;);

Produces:

&nbsp;&nbsp;&nbsp;&nbsp;par:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;t/startup/foo.t&#39;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;t/a/foo.t&#39;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;t/b/foo.t&#39;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;t/c/foo.t&#39;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;t/shutdown/foo.t&#39;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;t/d/foo.t&#39;


=cut</pre></td></tr>
<tr><td class="h">421</td><td colspan="7"></td></tr><tr><td class="h">422</td><td colspan="7"></td></tr><tr><td class="h">423</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub as_string {</td></tr>
<tr><td class="h">424</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L424">0</a></div></td><td><div class="c3">1</div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">425</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;_as_string( $self-&gt;{schedule} );</td></tr>
<tr><td class="h">426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">427</td><td colspan="7"></td></tr><tr><td class="h">428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _as_string {</td></tr>
<tr><td class="h">429</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="blib-lib-TAP-Parser-Scheduler-pm--condition.html#L429">0</a></div></td><td><div class="c0"><a href="blib-lib-TAP-Parser-Scheduler-pm--subroutine.html#L429">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $rule, $depth ) = ( shift, shift, shift || 0 );</td></tr>
<tr><td class="h">430</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $pad&nbsp;&nbsp;&nbsp;&nbsp;= &#39; &#39; x 2;</td></tr>
<tr><td class="h">431</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $indent = $pad x $depth;</td></tr>
<tr><td class="h">432</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L432">0</a></div><div class="c0" title="-/-"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L432">0</a></div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( !defined $rule ) {</td></tr>
<tr><td class="h">433</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &quot;$indent(undef)\n&quot;;</td></tr>
<tr><td class="h">434</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">435</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ( &#39;ARRAY&#39; eq ref $rule ) {</td></tr>
<tr><td class="h">436</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-TAP-Parser-Scheduler-pm--branch.html#L436">0</a></div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return unless @$rule;</td></tr>
<tr><td class="h">437</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $type = ( &#39;par&#39;, &#39;seq&#39; )[ $depth % 2 ];</td></tr>
<tr><td class="h">438</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return join(</td></tr>
<tr><td class="h">439</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&#39;, &quot;$indent$type:\n&quot;,</td></tr>
<tr><td class="h">440</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { $self-&gt;_as_string( $_, $depth + 1 ) } @$rule</td></tr>
<tr><td class="h">441</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">442</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">443</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">444</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &quot;$indent&#39;&quot; . $rule-&gt;filename . &quot;&#39;\n&quot;;</td></tr>
<tr><td class="h">445</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">446</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">447</td><td colspan="7"></td></tr><tr><td class="h">448</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
</table>
</body>
</html>
