<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.36
Devel::Cover is copyright 2001-2019, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: blib/lib/TAP/Harness.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">blib/lib/TAP/Harness.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c1">88.8%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>pod</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">package TAP::Harness;</td></tr>
<tr><td class="h">2</td><td colspan="7"></td></tr><tr><td class="h">3</td><td><div class="c3">21</div><div class="c3">21</div><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L3">21</a></div></td><td></td><td><div>198582</div><div>18</div><div>265</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">4</td><td><div class="c3">21</div><div class="c3">21</div><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L4">21</a></div></td><td></td><td><div>42</div><div>15</div><div>273</div></td><td class="s">use warnings;</td></tr>
<tr><td class="h">5</td><td><div class="c3">21</div><div class="c3">21</div><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L5">21</a></div></td><td></td><td><div>63</div><div>16</div><div>566</div></td><td class="s">use Carp;</td></tr>
<tr><td class="h">6</td><td colspan="7"></td></tr><tr><td class="h">7</td><td><div class="c3">21</div><div class="c3">21</div><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L7">21</a></div></td><td></td><td><div>62</div><div>12</div><div>339</div></td><td class="s">use File::Spec;</td></tr>
<tr><td class="h">8</td><td><div class="c3">21</div><div class="c3">21</div><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L8">21</a></div></td><td></td><td><div>42</div><div>25</div><div>454</div></td><td class="s">use File::Path;</td></tr>
<tr><td class="h">9</td><td><div class="c3">21</div><div class="c3">21</div><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L9">21</a></div></td><td></td><td><div>7904</div><div>49654</div><div>554</div></td><td class="s">use IO::Handle;</td></tr>
<tr><td class="h">10</td><td colspan="7"></td></tr><tr><td class="h">11</td><td><div class="c3">21</div><div class="c3">21</div><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L11">21</a></div></td><td></td><td><div>71</div><div>18</div><div>3435</div></td><td class="s">use base &#39;TAP::Base&#39;;</td></tr>
<tr><td class="h">12</td><td colspan="7"></td></tr><tr><td class="h">13 - 21</td><td colspan="6"></td><td class="s"><pre>=head1 NAME

TAP::Harness - Run test scripts with statistics

=head1 VERSION

Version 3.42

=cut</pre></td></tr>
<tr><td class="h">22</td><td colspan="7"></td></tr><tr><td class="h">23</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">our $VERSION = &#39;3.42&#39;;</td></tr>
<tr><td class="h">24</td><td colspan="7"></td></tr><tr><td class="h">25</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">$ENV{HARNESS_ACTIVE}&nbsp;&nbsp;= 1;</td></tr>
<tr><td class="h">26</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">$ENV{HARNESS_VERSION} = $VERSION;</td></tr>
<tr><td class="h">27</td><td colspan="7"></td></tr><tr><td class="h">28</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">END {</td></tr>
<tr><td class="h">29</td><td colspan="7"></td></tr><tr><td class="h">30</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# For VMS.</td></tr>
<tr><td class="h">31</td><td><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L31">21</a></div></td><td></td><td><div>2362</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;delete $ENV{HARNESS_ACTIVE};</td></tr>
<tr><td class="h">32</td><td><div class="c3">21</div></td><td></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;delete $ENV{HARNESS_VERSION};</td></tr>
<tr><td class="h">33</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">34</td><td colspan="7"></td></tr><tr><td class="h">35 - 46</td><td colspan="6"></td><td class="s"><pre>=head1 DESCRIPTION

This is a simple test harness which allows tests to be run and results
automatically aggregated and output to STDOUT.

=head1 SYNOPSIS

 use TAP::Harness;
 my $harness = TAP::Harness-&gt;new( \%args );
 $harness-&gt;runtests(@tests);

=cut</pre></td></tr>
<tr><td class="h">47</td><td colspan="7"></td></tr><tr><td class="h">48</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %VALIDATION_FOR;</td></tr>
<tr><td class="h">49</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my @FORMATTER_ARGS;</td></tr>
<tr><td class="h">50</td><td colspan="7"></td></tr><tr><td class="h">51</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _error {</td></tr>
<tr><td class="h">52</td><td><div class="c3">164</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L52">164</a></div></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">53</td><td><div class="c3">164</div></td><td><div class="c0" title="T/-"><a href="blib-lib-TAP-Harness-pm--branch.html#L53">50</a></div></td><td></td><td></td><td></td><td><div>234</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;{error} unless @_;</td></tr>
<tr><td class="h">54</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{error} = shift;</td></tr>
<tr><td class="h">55</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">56</td><td colspan="7"></td></tr><tr><td class="h">57</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">BEGIN {</td></tr>
<tr><td class="h">58</td><td colspan="7"></td></tr><tr><td class="h">59</td><td><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L59">21</a></div></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@FORMATTER_ARGS = qw(</td></tr>
<tr><td class="h">60</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directives verbosity timer failures comments errors stdout color</td></tr>
<tr><td class="h">61</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;show_count normalize</td></tr>
<tr><td class="h">62</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">63</td><td colspan="7"></td></tr><tr><td class="h">64</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;%VALIDATION_FOR = (</td></tr>
<tr><td class="h">65</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lib =&gt; sub {</td></tr>
<tr><td class="h">66</td><td><div class="c3">48</div></td><td></td><td></td><td></td><td></td><td><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $libs ) = @_;</td></tr>
<tr><td class="h">67</td><td><div class="c3">48</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L67">100</a></div></td><td></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$libs = [$libs] unless &#39;ARRAY&#39; eq ref $libs;</td></tr>
<tr><td class="h">68</td><td colspan="7"></td></tr><tr><td class="h">69</td><td><div class="c3">48</div><div class="c3">9</div></td><td></td><td></td><td></td><td></td><td><div>58</div><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ map {&quot;-I$_&quot;} @$libs ];</td></tr>
<tr><td class="h">70</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">71</td><td><div class="c3">47</div><div class="c3">47</div></td><td></td><td></td><td></td><td></td><td><div>40</div><div>47</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switches&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">72</td><td><div class="c3">7</div><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>19</div><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">73</td><td><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1</div><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;merge&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">74</td><td><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggregator_class&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">75</td><td><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>6</div><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatter_class&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">76</td><td><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1</div><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiplexer_class =&gt; sub { shift; shift },</td></tr>
<tr><td class="h">77</td><td><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parser_class&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">78</td><td><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1</div><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scheduler_class&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">79</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">80</td><td><div class="c3">3</div><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>2</div><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jobs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">81</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test_args&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">82</td><td><div class="c3">43</div><div class="c3">43</div></td><td></td><td></td><td></td><td></td><td><div>28</div><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ignore_exit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">83</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">84</td><td><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1</div><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rulesfile&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">85</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>3</div><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sources&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">86</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">87</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trap&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; sub { shift; shift },</td></tr>
<tr><td class="h">88</td><td><div class="c3">21</div></td><td></td><td></td><td></td><td></td><td><div>486</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">89</td><td colspan="7"></td></tr><tr><td class="h">90</td><td><div class="c3">21</div></td><td></td><td></td><td></td><td></td><td><div>122</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $method ( sort keys %VALIDATION_FOR ) {</td></tr>
<tr><td class="h">91</td><td><div class="c3">21</div><div class="c3">21</div><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L91">21</a></div></td><td></td><td><div>67</div><div>23</div><div>2952</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no strict &#39;refs&#39;;</td></tr>
<tr><td class="h">92</td><td><div class="c3">378</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L92">100</a></div></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--condition.html#L92">100</a></div></td><td></td><td></td><td><div>948</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $method eq &#39;lib&#39; || $method eq &#39;switches&#39; ) {</td></tr>
<tr><td class="h">93</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{$method} = sub {</td></tr>
<tr><td class="h">94</td><td><div class="c3">533</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L94">533</a></div></td><td></td><td><div>16733</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">95</td><td><div class="c3">533</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L95">100</a></div></td><td></td><td></td><td></td><td><div>513</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless (@_) {</td></tr>
<tr><td class="h">96</td><td><div class="c3">436</div></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--condition.html#L96">100</a></div></td><td></td><td></td><td><div>532</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{$method} ||= [];</td></tr>
<tr><td class="h">97</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return wantarray</td></tr>
<tr><td class="h">98</td><td><div class="c3">216</div></td><td></td><td></td><td></td><td></td><td><div>283</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? @{ $self-&gt;{$method} }</td></tr>
<tr><td class="h">99</td><td><div class="c3">436</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L99">100</a></div></td><td></td><td></td><td></td><td><div>595</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: $self-&gt;{$method};</td></tr>
<tr><td class="h">100</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">101</td><td><div class="c3">97</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L101">100</a></div></td><td></td><td></td><td></td><td><div>75</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_croak(&quot;Too many arguments to method &#39;$method&#39;&quot;)</td></tr>
<tr><td class="h">102</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if @_ &gt; 1;</td></tr>
<tr><td class="h">103</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $args = shift;</td></tr>
<tr><td class="h">104</td><td><div class="c3">96</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L104">100</a></div></td><td></td><td></td><td></td><td><div>106</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$args = [$args] unless ref $args;</td></tr>
<tr><td class="h">105</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{$method} = $args;</td></tr>
<tr><td class="h">106</td><td><div class="c3">96</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $self;</td></tr>
<tr><td class="h">107</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">108</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">109</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">110</td><td><div class="c3">336</div></td><td></td><td></td><td></td><td></td><td><div>563</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{$method} = sub {</td></tr>
<tr><td class="h">111</td><td><div class="c3">3234</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L111">3234</a></div></td><td></td><td><div>2062</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">112</td><td><div class="c3">3234</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L112">100</a></div></td><td></td><td></td><td></td><td><div>4629</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;{$method} unless @_;</td></tr>
<tr><td class="h">113</td><td><div class="c3">720</div></td><td></td><td></td><td></td><td></td><td><div>1038</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{$method} = shift;</td></tr>
<tr><td class="h">114</td><td><div class="c3">336</div></td><td></td><td></td><td></td><td></td><td><div>452</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">115</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">116</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">117</td><td colspan="7"></td></tr><tr><td class="h">118</td><td><div class="c3">21</div></td><td></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $method (@FORMATTER_ARGS) {</td></tr>
<tr><td class="h">119</td><td><div class="c3">21</div><div class="c3">21</div><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L119">21</a></div></td><td></td><td><div>97</div><div>50</div><div>778</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no strict &#39;refs&#39;;</td></tr>
<tr><td class="h">120</td><td><div class="c3">210</div></td><td></td><td></td><td></td><td></td><td><div>21854</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*{$method} = sub {</td></tr>
<tr><td class="h">121</td><td><div class="c3">14</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L121">14</a></div></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">122</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;formatter-&gt;$method(@_);</td></tr>
<tr><td class="h">123</td><td><div class="c3">210</div></td><td></td><td></td><td></td><td></td><td><div>268</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">124</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">126</td><td colspan="7"></td></tr><tr><td class="h">127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">128</td><td colspan="7"></td></tr><tr><td class="h">129 - 407</td><td colspan="6"></td><td class="s"><pre>=head1 METHODS

=head2 Class Methods

=head3 C&lt;new&gt;

 my %args = (
&nbsp;&nbsp;&nbsp;&nbsp;verbosity =&gt; 1,
&nbsp;&nbsp;&nbsp;&nbsp;lib&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [ &#39;lib&#39;, &#39;blib/lib&#39;, &#39;blib/arch&#39; ],
 )
 my $harness = TAP::Harness-&gt;new( \%args );

The constructor returns a new C&lt;TAP::Harness&gt; object. It accepts an
optional hashref whose allowed keys are:

=over 4

=item * C&lt;verbosity&gt;

Set the verbosity level:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;verbose&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print individual test results to STDOUT.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;normal
&nbsp;&nbsp;&nbsp;&nbsp;-1&nbsp;&nbsp;&nbsp;quiet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Suppress some test output (mostly failures 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while tests are running).
&nbsp;&nbsp;&nbsp;&nbsp;-2&nbsp;&nbsp;&nbsp;really quiet&nbsp;&nbsp;&nbsp;Suppress everything but the tests summary.
&nbsp;&nbsp;&nbsp;&nbsp;-3&nbsp;&nbsp;&nbsp;silent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Suppress everything.

=item * C&lt;timer&gt;

Append run time for each test to output. Uses L&lt;Time::HiRes&gt; if
available.

=item * C&lt;failures&gt;

Show test failures (this is a no-op if C&lt;verbose&gt; is selected).

=item * C&lt;comments&gt;

Show test comments (this is a no-op if C&lt;verbose&gt; is selected).

=item * C&lt;show_count&gt;

Update the running test count during testing.

=item * C&lt;normalize&gt;

Set to a true value to normalize the TAP that is emitted in verbose modes.

=item * C&lt;lib&gt;

Accepts a scalar value or array ref of scalar values indicating which
paths to allowed libraries should be included if Perl tests are
executed. Naturally, this only makes sense in the context of tests
written in Perl.

=item * C&lt;switches&gt;

Accepts a scalar value or array ref of scalar values indicating which
switches should be included if Perl tests are executed. Naturally, this
only makes sense in the context of tests written in Perl.

=item * C&lt;test_args&gt;

A reference to an C&lt;@INC&gt; style array of arguments to be passed to each
test program.

&nbsp;&nbsp;test_args =&gt; [&#39;foo&#39;, &#39;bar&#39;],

if you want to pass different arguments to each test then you should
pass a hash of arrays, keyed by the alias for each test:

&nbsp;&nbsp;test_args =&gt; {
&nbsp;&nbsp;&nbsp;&nbsp;my_test&nbsp;&nbsp;&nbsp;&nbsp;=&gt; [&#39;foo&#39;, &#39;bar&#39;],
&nbsp;&nbsp;&nbsp;&nbsp;other_test =&gt; [&#39;baz&#39;],
&nbsp;&nbsp;}

=item * C&lt;color&gt;

Attempt to produce color output.

=item * C&lt;exec&gt;

Typically, Perl tests are run through this. However, anything which
spits out TAP is fine. You can use this argument to specify the name of
the program (and optional switches) to run your tests with:

&nbsp;&nbsp;exec =&gt; [&#39;/usr/bin/ruby&#39;, &#39;-w&#39;]

You can also pass a subroutine reference in order to determine and
return the proper program to run based on a given test script. The
subroutine reference should expect the TAP::Harness object itself as the
first argument, and the file name as the second argument. It should
return an array reference containing the command to be run and including
the test file name. It can also simply return C&lt;undef&gt;, in which case
TAP::Harness will fall back on executing the test script in Perl:

&nbsp;&nbsp;&nbsp;&nbsp;exec =&gt; sub {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ( $harness, $test_file ) = @_;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Let Perl tests run.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return undef if $test_file =~ /[.]t$/;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return [ qw( /usr/bin/ruby -w ), $test_file ]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $test_file =~ /[.]rb$/;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}

If the subroutine returns a scalar with a newline or a filehandle, it
will be interpreted as raw TAP or as a TAP stream, respectively.

=item * C&lt;merge&gt;

If C&lt;merge&gt; is true the harness will create parsers that merge STDOUT
and STDERR together for any processes they start.

=item * C&lt;sources&gt;

I&lt;NEW to 3.18&gt;.

If set, C&lt;sources&gt; must be a hashref containing the names of the
L&lt;TAP::Parser::SourceHandler&gt;s to load and/or configure.&nbsp;&nbsp;The values are a
hash of configuration that will be accessible to the source handlers via
L&lt;TAP::Parser::Source/config_for&gt;.

For example:

&nbsp;&nbsp;sources =&gt; {
&nbsp;&nbsp;&nbsp;&nbsp;Perl =&gt; { exec =&gt; &#39;/path/to/custom/perl&#39; },
&nbsp;&nbsp;&nbsp;&nbsp;File =&gt; { extensions =&gt; [ &#39;.tap&#39;, &#39;.txt&#39; ] },
&nbsp;&nbsp;&nbsp;&nbsp;MyCustom =&gt; { some =&gt; &#39;config&#39; },
&nbsp;&nbsp;}

The C&lt;sources&gt; parameter affects how C&lt;source&gt;, C&lt;tap&gt; and C&lt;exec&gt; parameters
are handled.

For more details, see the C&lt;sources&gt; parameter in L&lt;TAP::Parser/new&gt;,
L&lt;TAP::Parser::Source&gt;, and L&lt;TAP::Parser::IteratorFactory&gt;.

=item * C&lt;aggregator_class&gt;

The name of the class to use to aggregate test results. The default is
L&lt;TAP::Parser::Aggregator&gt;.

=item * C&lt;version&gt;

I&lt;NEW to 3.22&gt;.

Assume this TAP version for L&lt;TAP::Parser&gt; instead of default TAP
version 12.

=item * C&lt;formatter_class&gt;

The name of the class to use to format output. The default is
L&lt;TAP::Formatter::Console&gt;, or L&lt;TAP::Formatter::File&gt; if the output
isn&#39;t a TTY.

=item * C&lt;multiplexer_class&gt;

The name of the class to use to multiplex tests during parallel testing.
The default is L&lt;TAP::Parser::Multiplexer&gt;.

=item * C&lt;parser_class&gt;

The name of the class to use to parse TAP. The default is
L&lt;TAP::Parser&gt;.

=item * C&lt;scheduler_class&gt;

The name of the class to use to schedule test execution. The default is
L&lt;TAP::Parser::Scheduler&gt;.

=item * C&lt;formatter&gt;

If set C&lt;formatter&gt; must be an object that is capable of formatting the
TAP output. See L&lt;TAP::Formatter::Console&gt; for an example.

=item * C&lt;errors&gt;

If parse errors are found in the TAP output, a note of this will be
made in the summary report. To see all of the parse errors, set this
argument to true:

&nbsp;&nbsp;errors =&gt; 1

=item * C&lt;directives&gt;

If set to a true value, only test results with directives will be
displayed. This overrides other settings such as C&lt;verbose&gt; or
C&lt;failures&gt;.

=item * C&lt;ignore_exit&gt;

If set to a true value instruct C&lt;TAP::Parser&gt; to ignore exit and wait
status from test scripts.

=item * C&lt;jobs&gt;

The maximum number of parallel tests to run at any time.&nbsp;&nbsp;Which tests
can be run in parallel is controlled by C&lt;rules&gt;.&nbsp;&nbsp;The default is to
run only one test at a time.

=item * C&lt;rules&gt;

A reference to a hash of rules that control which tests may be executed in
parallel. If no rules are declared and L&lt;CPAN::Meta::YAML&gt; is available,
C&lt;TAP::Harness&gt; attempts to load rules from a YAML file specified by the
C&lt;rulesfile&gt; parameter. If no rules file exists, the default is for all
tests to be eligible to be run in parallel.

Here some simple examples. For the full details of the data structure
and the related glob-style pattern matching, see
L&lt;TAP::Parser::Scheduler/&quot;Rules data structure&quot;&gt;.

&nbsp;&nbsp;&nbsp;&nbsp;# Run all tests in sequence, except those starting with &quot;p&quot;
&nbsp;&nbsp;&nbsp;&nbsp;$harness-&gt;rules({
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par =&gt; &#39;t/p*.t&#39;
&nbsp;&nbsp;&nbsp;&nbsp;});

&nbsp;&nbsp;&nbsp;&nbsp;# Equivalent YAML file
&nbsp;&nbsp;&nbsp;&nbsp;---
&nbsp;&nbsp;&nbsp;&nbsp;par: t/p*.t

&nbsp;&nbsp;&nbsp;&nbsp;# Run all tests in parallel, except those starting with &quot;p&quot;
&nbsp;&nbsp;&nbsp;&nbsp;$harness-&gt;rules({
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq =&gt; [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ seq =&gt; &#39;t/p*.t&#39; },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ par =&gt; &#39;**&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],
&nbsp;&nbsp;&nbsp;&nbsp;});

&nbsp;&nbsp;&nbsp;&nbsp;# Equivalent YAML file
&nbsp;&nbsp;&nbsp;&nbsp;---
&nbsp;&nbsp;&nbsp;&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- seq: t/p*.t
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- par: **

&nbsp;&nbsp;&nbsp;&nbsp;# Run some&nbsp;&nbsp;startup tests in sequence, then some parallel tests than some
&nbsp;&nbsp;&nbsp;&nbsp;# teardown tests in sequence.
&nbsp;&nbsp;&nbsp;&nbsp;$harness-&gt;rules({
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq =&gt; [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ seq =&gt; &#39;t/startup/*.t&#39; },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ par =&gt; [&#39;t/a/*.t&#39;,&#39;t/b/*.t&#39;,&#39;t/c/*.t&#39;], }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ seq =&gt; &#39;t/shutdown/*.t&#39; },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],

&nbsp;&nbsp;&nbsp;&nbsp;});

&nbsp;&nbsp;&nbsp;&nbsp;# Equivalent YAML file
&nbsp;&nbsp;&nbsp;&nbsp;---
&nbsp;&nbsp;&nbsp;&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- seq: t/startup/*.t
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- par:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- t/a/*.t
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- t/b/*.t
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- t/c/*.t
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- seq: t/shutdown/*.t

This is an experimental feature and the interface may change.

=item * C&lt;rulesfiles&gt;

This specifies where to find a YAML file of test scheduling rules.&nbsp;&nbsp;If not
provided, it looks for a default file to use.&nbsp;&nbsp;It first checks for a file given
in the C&lt;HARNESS_RULESFILE&gt; environment variable, then it checks for
F&lt;testrules.yml&gt; and then F&lt;t/testrules.yml&gt;.

=item * C&lt;stdout&gt;

A filehandle for catching standard output.

=item * C&lt;trap&gt;

Attempt to print summary information if run is interrupted by
SIGINT (Ctrl-C).

=back

Any keys for which the value is C&lt;undef&gt; will be ignored.

=cut</pre></td></tr>
<tr><td class="h">408</td><td colspan="7"></td></tr><tr><td class="h">409</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># new supplied by TAP::Base</td></tr>
<tr><td class="h">410</td><td colspan="7"></td></tr><tr><td class="h">411</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h">412</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @legal_callback = qw(</td></tr>
<tr><td class="h">413</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parser_args</td></tr>
<tr><td class="h">414</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;made_parser</td></tr>
<tr><td class="h">415</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;before_runtests</td></tr>
<tr><td class="h">416</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;after_runtests</td></tr>
<tr><td class="h">417</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;after_test</td></tr>
<tr><td class="h">418</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">419</td><td colspan="7"></td></tr><tr><td class="h">420</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %default_class = (</td></tr>
<tr><td class="h">421</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggregator_class&nbsp;&nbsp;=&gt; &#39;TAP::Parser::Aggregator&#39;,</td></tr>
<tr><td class="h">422</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatter_class&nbsp;&nbsp;&nbsp;=&gt; &#39;TAP::Formatter::Console&#39;,</td></tr>
<tr><td class="h">423</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiplexer_class =&gt; &#39;TAP::Parser::Multiplexer&#39;,</td></tr>
<tr><td class="h">424</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parser_class&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; &#39;TAP::Parser&#39;,</td></tr>
<tr><td class="h">425</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scheduler_class&nbsp;&nbsp;&nbsp;=&gt; &#39;TAP::Parser::Scheduler&#39;,</td></tr>
<tr><td class="h">426</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">427</td><td colspan="7"></td></tr><tr><td class="h">428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;sub _initialize {</td></tr>
<tr><td class="h">429</td><td><div class="c3">93</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L429">93</a></div></td><td></td><td><div>137</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $arg_for ) = @_;</td></tr>
<tr><td class="h">430</td><td><div class="c3">93</div></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--condition.html#L430">100</a></div></td><td></td><td></td><td><div>317</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$arg_for ||= {};</td></tr>
<tr><td class="h">431</td><td colspan="7"></td></tr><tr><td class="h">432</td><td><div class="c3">93</div></td><td></td><td></td><td></td><td></td><td><div>192</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;SUPER::_initialize( $arg_for, \@legal_callback );</td></tr>
<tr><td class="h">433</td><td><div class="c3">93</div></td><td></td><td></td><td></td><td></td><td><div>245</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %arg_for = %$arg_for;&nbsp;&nbsp;&nbsp;&nbsp;# force a shallow copy</td></tr>
<tr><td class="h">434</td><td colspan="7"></td></tr><tr><td class="h">435</td><td><div class="c3">93</div></td><td></td><td></td><td></td><td></td><td><div>543</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $name ( sort keys %VALIDATION_FOR ) {</td></tr>
<tr><td class="h">436</td><td><div class="c3">1674</div></td><td></td><td></td><td></td><td></td><td><div>932</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $property = delete $arg_for{$name};</td></tr>
<tr><td class="h">437</td><td><div class="c3">1674</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L437">100</a></div></td><td></td><td></td><td></td><td><div>1293</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( defined $property ) {</td></tr>
<tr><td class="h">438</td><td><div class="c3">164</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $validate = $VALIDATION_FOR{$name};</td></tr>
<tr><td class="h">439</td><td colspan="7"></td></tr><tr><td class="h">440</td><td><div class="c3">164</div></td><td></td><td></td><td></td><td></td><td><div>228</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $value = $self-&gt;$validate($property);</td></tr>
<tr><td class="h">441</td><td><div class="c3">164</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L441">50</a></div></td><td></td><td></td><td></td><td><div>179</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $self-&gt;_error ) {</td></tr>
<tr><td class="h">442</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_croak;</td></tr>
<tr><td class="h">443</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">444</td><td><div class="c3">164</div></td><td></td><td></td><td></td><td></td><td><div>313</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;$name($value);</td></tr>
<tr><td class="h">445</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">446</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">447</td><td colspan="7"></td></tr><tr><td class="h">448</td><td><div class="c3">93</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L448">100</a></div></td><td></td><td></td><td></td><td><div>252</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;jobs(1) unless defined $self-&gt;jobs;</td></tr>
<tr><td class="h">449</td><td colspan="7"></td></tr><tr><td class="h">450</td><td><div class="c3">93</div></td><td><div class="c0" title="T/-"><a href="blib-lib-TAP-Harness-pm--branch.html#L450">50</a></div></td><td></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ! defined $self-&gt;rules ) {</td></tr>
<tr><td class="h">451</td><td><div class="c3">93</div></td><td></td><td></td><td></td><td></td><td><div>113</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_maybe_load_rulesfile;</td></tr>
<tr><td class="h">452</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">453</td><td colspan="7"></td></tr><tr><td class="h">454</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $default_class{formatter_class} = &#39;TAP::Formatter::File&#39;</td></tr>
<tr><td class="h">455</td><td><div class="c3">93</div></td><td><div class="c0" title="T/-"><a href="blib-lib-TAP-Harness-pm--branch.html#L455">50</a></div></td><td><div class="c0"><a href="blib-lib-TAP-Harness-pm--condition.html#L455">33</a></div><div class="c3"><a href="blib-lib-TAP-Harness-pm--condition.html#L455">100</a></div></td><td></td><td></td><td><div>463</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless -t ( $arg_for{stdout} || \*STDOUT ) &amp;&amp; !$ENV{HARNESS_NOTTY};</td></tr>
<tr><td class="h">456</td><td colspan="7"></td></tr><tr><td class="h">457</td><td><div class="c3">93</div></td><td></td><td></td><td></td><td></td><td><div>149</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ( my ( $attr, $class ) = each %default_class ) {</td></tr>
<tr><td class="h">458</td><td><div class="c3">465</div></td><td></td><td><div class="c0"><a href="blib-lib-TAP-Harness-pm--condition.html#L458">67</a></div></td><td></td><td></td><td><div>431</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;$attr( $self-&gt;$attr() || $class );</td></tr>
<tr><td class="h">459</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">460</td><td colspan="7"></td></tr><tr><td class="h">461</td><td><div class="c3">93</div></td><td><div class="c0" title="T/-"><a href="blib-lib-TAP-Harness-pm--branch.html#L461">50</a></div></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ( $self-&gt;formatter ) {</td></tr>
<tr><td class="h">462</td><td colspan="7"></td></tr><tr><td class="h">463</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This is a little bodge to preserve legacy behaviour. It&#39;s</td></tr>
<tr><td class="h">464</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# pretty horrible that we know which args are destined for</td></tr>
<tr><td class="h">465</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# the formatter.</td></tr>
<tr><td class="h">466</td><td><div class="c3">93</div></td><td></td><td></td><td></td><td></td><td><div>115</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %formatter_args = ( jobs =&gt; $self-&gt;jobs );</td></tr>
<tr><td class="h">467</td><td><div class="c3">93</div></td><td></td><td></td><td></td><td></td><td><div>122</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $name (@FORMATTER_ARGS) {</td></tr>
<tr><td class="h">468</td><td><div class="c3">930</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L468">100</a></div></td><td></td><td></td><td></td><td><div>766</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( defined( my $property = delete $arg_for{$name} ) ) {</td></tr>
<tr><td class="h">469</td><td><div class="c3">185</div></td><td></td><td></td><td></td><td></td><td><div>222</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$formatter_args{$name} = $property;</td></tr>
<tr><td class="h">470</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">471</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">472</td><td colspan="7"></td></tr><tr><td class="h">473</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;formatter(</td></tr>
<tr><td class="h">474</td><td><div class="c3">93</div></td><td></td><td></td><td></td><td></td><td><div>96</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_construct( $self-&gt;formatter_class, \%formatter_args )</td></tr>
<tr><td class="h">475</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">476</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">477</td><td colspan="7"></td></tr><tr><td class="h">478</td><td><div class="c3">91</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L478">100</a></div></td><td></td><td></td><td></td><td><div>223</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( my @props = sort keys %arg_for ) {</td></tr>
<tr><td class="h">479</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_croak(&quot;Unknown arguments to TAP::Harness::new (@props)&quot;);</td></tr>
<tr><td class="h">480</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">481</td><td colspan="7"></td></tr><tr><td class="h">482</td><td><div class="c3">90</div></td><td></td><td></td><td></td><td></td><td><div>211</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $self;</td></tr>
<tr><td class="h">483</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">484</td><td colspan="7"></td></tr><tr><td class="h">485</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;sub _maybe_load_rulesfile {</td></tr>
<tr><td class="h">486</td><td><div class="c3">93</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L486">93</a></div></td><td></td><td><div>360</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($self) = @_;</td></tr>
<tr><td class="h">487</td><td colspan="7"></td></tr><tr><td class="h">488</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($rulesfile) =&nbsp;&nbsp;&nbsp;defined $self-&gt;rulesfile ? $self-&gt;rulesfile :</td></tr>
<tr><td class="h">489</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defined($ENV{HARNESS_RULESFILE}) ? $ENV{HARNESS_RULESFILE} :</td></tr>
<tr><td class="h">490</td><td><div class="c3">93</div><div class="c3">182</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L490">100</a></div><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L490">100</a></div></td><td></td><td></td><td></td><td><div>135</div><div>464</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep { -r } qw(./testrules.yml t/testrules.yml);</td></tr>
<tr><td class="h">491</td><td colspan="7"></td></tr><tr><td class="h">492</td><td><div class="c3">93</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L492">100</a></div></td><td><div class="c0"><a href="blib-lib-TAP-Harness-pm--condition.html#L492">67</a></div></td><td></td><td></td><td><div>128</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( defined $rulesfile &amp;&amp; -r $rulesfile ) {</td></tr>
<tr><td class="h">493</td><td><div class="c3">4</div><div class="c3">4</div><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L493">50</a></div></td><td></td><td></td><td></td><td><div>2</div><div>11</div><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ! eval { require CPAN::Meta::YAML; 1} ) {</td></tr>
<tr><td class="h">494</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn &quot;CPAN::Meta::YAML required to process $rulesfile&quot; ;</td></tr>
<tr><td class="h">495</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">496</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">497</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L497">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $layer = $] lt &quot;5.008&quot; ? &quot;&quot; : &quot;:encoding(UTF-8)&quot;;</td></tr>
<tr><td class="h">498</td><td><div class="c3">4</div><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L498">50</a></div></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L498">1</a></div></td><td></td><td><div>44</div><div>2</div><div>0</div><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open my $fh, &quot;&lt;$layer&quot;, $rulesfile</td></tr>
<tr><td class="h">499</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or die &quot;Couldn&#39;t open $rulesfile: $!&quot;;</td></tr>
<tr><td class="h">500</td><td><div class="c3">4</div><div class="c3">4</div><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>93442</div><div>7</div><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $yaml_text = do { local $/; &lt;$fh&gt; };</td></tr>
<tr><td class="h">501</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L501">50</a></div></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $yaml = CPAN::Meta::YAML-&gt;read_string($yaml_text)</td></tr>
<tr><td class="h">502</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or die CPAN::Meta::YAML-&gt;errstr;</td></tr>
<tr><td class="h">503</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>406</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;rules( $yaml-&gt;[0] );</td></tr>
<tr><td class="h">504</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">505</td><td><div class="c3">93</div></td><td></td><td></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">506</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">507</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">508</td><td colspan="7"></td></tr><tr><td class="h">509</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">510</td><td colspan="7"></td></tr><tr><td class="h">511 - 542</td><td colspan="6"></td><td class="s"><pre>=head2 Instance Methods

=head3 C&lt;runtests&gt;

&nbsp;&nbsp;&nbsp;&nbsp;$harness-&gt;runtests(@tests);

Accepts an array of C&lt;@tests&gt; to be run. This should generally be the
names of test files, but this is not required. Each element in C&lt;@tests&gt;
will be passed to C&lt;TAP::Parser::new()&gt; as a C&lt;source&gt;. See
L&lt;TAP::Parser&gt; for more information.

It is possible to provide aliases that will be displayed in place of the
test name by supplying the test as a reference to an array containing
C&lt;&lt; [ $test, $alias ] &gt;&gt;:

&nbsp;&nbsp;&nbsp;&nbsp;$harness-&gt;runtests( [ &#39;t/foo.t&#39;, &#39;Foo Once&#39; ],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ &#39;t/foo.t&#39;, &#39;Foo Twice&#39; ] );

Normally it is an error to attempt to run the same test twice. Aliases
allow you to overcome this limitation by giving each run of the test a
unique name.

Tests will be run in the order found.

If the environment variable C&lt;PERL_TEST_HARNESS_DUMP_TAP&gt; is defined it
should name a directory into which a copy of the raw TAP for each test
will be written. TAP is written to files named for each test.
Subdirectories will be created as needed.

Returns a L&lt;TAP::Parser::Aggregator&gt; containing the test results.

=cut</pre></td></tr>
<tr><td class="h">543</td><td colspan="7"></td></tr><tr><td class="h">544</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub runtests {</td></tr>
<tr><td class="h">545</td><td><div class="c3">44</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L545">44</a></div></td><td><div class="c3">1</div></td><td><div>32976</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, @tests ) = @_;</td></tr>
<tr><td class="h">546</td><td colspan="7"></td></tr><tr><td class="h">547</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $aggregate = $self-&gt;_construct( $self-&gt;aggregator_class );</td></tr>
<tr><td class="h">548</td><td colspan="7"></td></tr><tr><td class="h">549</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_make_callback( &#39;before_runtests&#39;, $aggregate );</td></tr>
<tr><td class="h">550</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;start;</td></tr>
<tr><td class="h">551</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $finish = sub {</td></tr>
<tr><td class="h">552</td><td><div class="c3">42</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L552">42</a></div></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $interrupted = shift;</td></tr>
<tr><td class="h">553</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>89</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;stop;</td></tr>
<tr><td class="h">554</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>349</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;summary( $aggregate, $interrupted );</td></tr>
<tr><td class="h">555</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>211</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_make_callback( &#39;after_runtests&#39;, $aggregate );</td></tr>
<tr><td class="h">556</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>454</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">557</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $run = sub {</td></tr>
<tr><td class="h">558</td><td><div class="c3">44</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L558">44</a></div></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;aggregate_tests( $aggregate, @tests );</td></tr>
<tr><td class="h">559</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>46</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$finish-&gt;();</td></tr>
<tr><td class="h">560</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">561</td><td colspan="7"></td></tr><tr><td class="h">562</td><td><div class="c3">44</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L562">50</a></div></td><td></td><td></td><td></td><td><div>88</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $self-&gt;trap ) {</td></tr>
<tr><td class="h">563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $SIG{INT} = sub {</td></tr>
<tr><td class="h">564</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L564">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;\n&quot;;</td></tr>
<tr><td class="h">565</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$finish-&gt;(1);</td></tr>
<tr><td class="h">566</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit;</td></tr>
<tr><td class="h">567</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">568</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$run-&gt;();</td></tr>
<tr><td class="h">569</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">570</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">571</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$run-&gt;();</td></tr>
<tr><td class="h">572</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">573</td><td colspan="7"></td></tr><tr><td class="h">574</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>259</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $aggregate;</td></tr>
<tr><td class="h">575</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">576</td><td colspan="7"></td></tr><tr><td class="h">577 - 583</td><td colspan="6"></td><td class="s"><pre>=head3 C&lt;summary&gt;

&nbsp;&nbsp;$harness-&gt;summary( $aggregator );

Output the summary for a L&lt;TAP::Parser::Aggregator&gt;.

=cut</pre></td></tr>
<tr><td class="h">584</td><td colspan="7"></td></tr><tr><td class="h">585</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub summary {</td></tr>
<tr><td class="h">586</td><td><div class="c3">42</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L586">42</a></div></td><td><div class="c3">1</div></td><td><div>56</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, @args ) = @_;</td></tr>
<tr><td class="h">587</td><td><div class="c3">42</div></td><td></td><td></td><td></td><td></td><td><div>88</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;formatter-&gt;summary(@args);</td></tr>
<tr><td class="h">588</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">589</td><td colspan="7"></td></tr><tr><td class="h">590</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _after_test {</td></tr>
<tr><td class="h">591</td><td><div class="c3">105</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L591">105</a></div></td><td></td><td><div>132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $aggregate, $job, $parser ) = @_;</td></tr>
<tr><td class="h">592</td><td colspan="7"></td></tr><tr><td class="h">593</td><td><div class="c3">105</div></td><td></td><td></td><td></td><td></td><td><div>193</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_make_callback( &#39;after_test&#39;, $job-&gt;as_array_ref, $parser );</td></tr>
<tr><td class="h">594</td><td><div class="c3">105</div></td><td></td><td></td><td></td><td></td><td><div>142</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$aggregate-&gt;add( $job-&gt;description, $parser );</td></tr>
<tr><td class="h">595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">596</td><td colspan="7"></td></tr><tr><td class="h">597</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _bailout {</td></tr>
<tr><td class="h">598</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L598">2</a></div></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $result ) = @_;</td></tr>
<tr><td class="h">599</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $explanation = $result-&gt;explanation;</td></tr>
<tr><td class="h">600</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="blib-lib-TAP-Harness-pm--branch.html#L600">50</a></div></td><td></td><td></td><td></td><td><div>191</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;die &quot;FAILED--Further testing stopped&quot;</td></tr>
<tr><td class="h">601</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. ( $explanation ? &quot;: $explanation\n&quot; : &quot;.\n&quot; );</td></tr>
<tr><td class="h">602</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">603</td><td colspan="7"></td></tr><tr><td class="h">604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _aggregate_parallel {</td></tr>
<tr><td class="h">605</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L605">1</a></div></td><td></td><td><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $aggregate, $scheduler ) = @_;</td></tr>
<tr><td class="h">606</td><td colspan="7"></td></tr><tr><td class="h">607</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $jobs = $self-&gt;jobs;</td></tr>
<tr><td class="h">608</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $mux&nbsp;&nbsp;= $self-&gt;_construct( $self-&gt;multiplexer_class );</td></tr>
<tr><td class="h">609</td><td colspan="7"></td></tr><tr><td class="h">610</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;RESULT: {</td></tr>
<tr><td class="h">611</td><td colspan="7"></td></tr><tr><td class="h">612</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Keep multiplexer topped up</td></tr>
<tr><td class="h">613</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILL:</td></tr>
<tr><td class="h">614</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ( $mux-&gt;parsers &lt; $jobs ) {</td></tr>
<tr><td class="h">615</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $job = $scheduler-&gt;get_job;</td></tr>
<tr><td class="h">616</td><td colspan="7"></td></tr><tr><td class="h">617</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If we hit a spinner stop filling and start running.</td></tr>
<tr><td class="h">618</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L618">100</a></div></td><td><div class="c0"><a href="blib-lib-TAP-Harness-pm--condition.html#L618">67</a></div></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last FILL if !defined $job || $job-&gt;is_spinner;</td></tr>
<tr><td class="h">619</td><td colspan="7"></td></tr><tr><td class="h">620</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ( $parser, $session ) = $self-&gt;make_parser($job);</td></tr>
<tr><td class="h">621</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$mux-&gt;add( $parser, [ $session, $job ] );</td></tr>
<tr><td class="h">622</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">623</td><td colspan="7"></td></tr><tr><td class="h">624</td><td><div class="c3">5</div></td><td><div class="c0" title="T/-"><a href="blib-lib-TAP-Harness-pm--branch.html#L624">50</a></div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( my ( $parser, $stash, $result ) = $mux-&gt;next ) {</td></tr>
<tr><td class="h">625</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ( $session, $job ) = @$stash;</td></tr>
<tr><td class="h">626</td><td><div class="c3">5</div></td><td><div class="c0" title="T/-"><a href="blib-lib-TAP-Harness-pm--branch.html#L626">50</a></div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( defined $result ) {</td></tr>
<tr><td class="h">627</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$session-&gt;result($result);</td></tr>
<tr><td class="h">628</td><td><div class="c3">5</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L628">100</a></div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_bailout($result) if $result-&gt;is_bailout;</td></tr>
<tr><td class="h">629</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">630</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">631</td><td colspan="7"></td></tr><tr><td class="h">632</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# End of parser. Automatically removed from the mux.</td></tr>
<tr><td class="h">633</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;finish_parser( $parser, $session );</td></tr>
<tr><td class="h">634</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_after_test( $aggregate, $job, $parser );</td></tr>
<tr><td class="h">635</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$job-&gt;finish;</td></tr>
<tr><td class="h">636</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">637</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redo RESULT;</td></tr>
<tr><td class="h">638</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">640</td><td colspan="7"></td></tr><tr><td class="h">641</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">643</td><td colspan="7"></td></tr><tr><td class="h">644</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _aggregate_single {</td></tr>
<tr><td class="h">645</td><td><div class="c3">78</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L645">78</a></div></td><td></td><td><div>71</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $aggregate, $scheduler ) = @_;</td></tr>
<tr><td class="h">646</td><td colspan="7"></td></tr><tr><td class="h">647</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;JOB:</td></tr>
<tr><td class="h">648</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while ( my $job = $scheduler-&gt;get_job ) {</td></tr>
<tr><td class="h">649</td><td><div class="c3">106</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L649">50</a></div></td><td></td><td></td><td></td><td><div>271</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next JOB if $job-&gt;is_spinner;</td></tr>
<tr><td class="h">650</td><td colspan="7"></td></tr><tr><td class="h">651</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>183</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ( $parser, $session ) = $self-&gt;make_parser($job);</td></tr>
<tr><td class="h">652</td><td colspan="7"></td></tr><tr><td class="h">653</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>280</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ( defined( my $result = $parser-&gt;next ) ) {</td></tr>
<tr><td class="h">654</td><td><div class="c3">435</div></td><td></td><td></td><td></td><td></td><td><div>780</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$session-&gt;result($result);</td></tr>
<tr><td class="h">655</td><td><div class="c3">435</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L655">100</a></div></td><td></td><td></td><td></td><td><div>497</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $result-&gt;is_bailout ) {</td></tr>
<tr><td class="h">656</td><td colspan="7"></td></tr><tr><td class="h">657</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Keep reading until input is exhausted in the hope</td></tr>
<tr><td class="h">658</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of allowing any pending diagnostics to show up.</td></tr>
<tr><td class="h">659</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 while $parser-&gt;next;</td></tr>
<tr><td class="h">660</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_bailout($result);</td></tr>
<tr><td class="h">661</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">662</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">663</td><td colspan="7"></td></tr><tr><td class="h">664</td><td><div class="c3">105</div></td><td></td><td></td><td></td><td></td><td><div>269</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;finish_parser( $parser, $session );</td></tr>
<tr><td class="h">665</td><td><div class="c3">105</div></td><td></td><td></td><td></td><td></td><td><div>293</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_after_test( $aggregate, $job, $parser );</td></tr>
<tr><td class="h">666</td><td><div class="c3">105</div></td><td></td><td></td><td></td><td></td><td><div>220</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$job-&gt;finish;</td></tr>
<tr><td class="h">667</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">668</td><td colspan="7"></td></tr><tr><td class="h">669</td><td><div class="c3">77</div></td><td></td><td></td><td></td><td></td><td><div>103</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">670</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">671</td><td colspan="7"></td></tr><tr><td class="h">672 - 724</td><td colspan="6"></td><td class="s"><pre>=head3 C&lt;aggregate_tests&gt;

&nbsp;&nbsp;$harness-&gt;aggregate_tests( $aggregate, @tests );

Run the named tests and display a summary of result. Tests will be run
in the order found.

Test results will be added to the supplied L&lt;TAP::Parser::Aggregator&gt;.
C&lt;aggregate_tests&gt; may be called multiple times to run several sets of
tests. Multiple C&lt;Test::Harness&gt; instances may be used to pass results
to a single aggregator so that different parts of a complex test suite
may be run using different C&lt;TAP::Harness&gt; settings. This is useful, for
example, in the case where some tests should run in parallel but others
are unsuitable for parallel execution.

&nbsp;&nbsp;&nbsp;&nbsp;my $formatter&nbsp;&nbsp;&nbsp;= TAP::Formatter::Console-&gt;new;
&nbsp;&nbsp;&nbsp;&nbsp;my $ser_harness = TAP::Harness-&gt;new( { formatter =&gt; $formatter } );
&nbsp;&nbsp;&nbsp;&nbsp;my $par_harness = TAP::Harness-&gt;new(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;formatter =&gt; $formatter,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jobs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; 9
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;);
&nbsp;&nbsp;&nbsp;&nbsp;my $aggregator = TAP::Parser::Aggregator-&gt;new;

&nbsp;&nbsp;&nbsp;&nbsp;$aggregator-&gt;start();
&nbsp;&nbsp;&nbsp;&nbsp;$ser_harness-&gt;aggregate_tests( $aggregator, @ser_tests );
&nbsp;&nbsp;&nbsp;&nbsp;$par_harness-&gt;aggregate_tests( $aggregator, @par_tests );
&nbsp;&nbsp;&nbsp;&nbsp;$aggregator-&gt;stop();
&nbsp;&nbsp;&nbsp;&nbsp;$formatter-&gt;summary($aggregator);

Note that for simpler testing requirements it will often be possible to
replace the above code with a single call to C&lt;runtests&gt;.

Each element of the C&lt;@tests&gt; array is either:

=over

=item * the source name of a test to run

=item * a reference to a [ source name, display name ] array

=back

In the case of a perl test suite, typically I&lt;source names&gt; are simply the file
names of the test scripts to run.

When you supply a separate display name it becomes possible to run a
test more than once; the display name is effectively the alias by which
the test is known inside the harness. The harness doesn&#39;t care if it
runs the same test more than once when each invocation uses a
different name.

=cut</pre></td></tr>
<tr><td class="h">725</td><td colspan="7"></td></tr><tr><td class="h">726</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub aggregate_tests {</td></tr>
<tr><td class="h">727</td><td><div class="c3">79</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L727">79</a></div></td><td><div class="c3">1</div></td><td><div>106</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $aggregate, @tests ) = @_;</td></tr>
<tr><td class="h">728</td><td colspan="7"></td></tr><tr><td class="h">729</td><td><div class="c3">79</div></td><td></td><td></td><td></td><td></td><td><div>125</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $jobs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $self-&gt;jobs;</td></tr>
<tr><td class="h">730</td><td><div class="c3">79</div></td><td></td><td></td><td></td><td></td><td><div>182</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $scheduler = $self-&gt;make_scheduler(@tests);</td></tr>
<tr><td class="h">731</td><td colspan="7"></td></tr><tr><td class="h">732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# #12458</td></tr>
<tr><td class="h">733</td><td><div class="c3">79</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L733">100</a></div></td><td></td><td></td><td></td><td><div>110</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $ENV{HARNESS_IS_VERBOSE} = 1</td></tr>
<tr><td class="h">734</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if $self-&gt;formatter-&gt;verbosity &gt; 0;</td></tr>
<tr><td class="h">735</td><td colspan="7"></td></tr><tr><td class="h">736</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Formatter gets only names.</td></tr>
<tr><td class="h">737</td><td><div class="c3">79</div><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>78</div><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;formatter-&gt;prepare( map { $_-&gt;description } $scheduler-&gt;get_all );</td></tr>
<tr><td class="h">738</td><td colspan="7"></td></tr><tr><td class="h">739</td><td><div class="c3">79</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L739">100</a></div></td><td></td><td></td><td></td><td><div>97</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $self-&gt;jobs &gt; 1 ) {</td></tr>
<tr><td class="h">740</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_aggregate_parallel( $aggregate, $scheduler );</td></tr>
<tr><td class="h">741</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">742</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">743</td><td><div class="c3">78</div></td><td></td><td></td><td></td><td></td><td><div>138</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_aggregate_single( $aggregate, $scheduler );</td></tr>
<tr><td class="h">744</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">745</td><td colspan="7"></td></tr><tr><td class="h">746</td><td><div class="c3">77</div></td><td></td><td></td><td></td><td></td><td><div>374</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">747</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">748</td><td colspan="7"></td></tr><tr><td class="h">749</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _add_descriptions {</td></tr>
<tr><td class="h">750</td><td><div class="c3">84</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L750">84</a></div></td><td></td><td><div>1717</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">751</td><td colspan="7"></td></tr><tr><td class="h">752</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Turn unwrapped scalars into anonymous arrays and copy the name as</td></tr>
<tr><td class="h">753</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# the description for tests that have only a name.</td></tr>
<tr><td class="h">754</td><td><div class="c3">122</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L754">100</a></div></td><td></td><td></td><td></td><td><div>279</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return map { @$_ == 1 ? [ $_-&gt;[0], $_-&gt;[0] ] : $_ }</td></tr>
<tr><td class="h">755</td><td><div class="c3">84</div><div class="c3">122</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L755">100</a></div></td><td></td><td></td><td></td><td><div>88</div><div>194</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map { &#39;ARRAY&#39; eq ref $_ ? $_ : [$_] } @_;</td></tr>
<tr><td class="h">756</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">757</td><td colspan="7"></td></tr><tr><td class="h">758 - 765</td><td colspan="6"></td><td class="s"><pre>=head3 C&lt;make_scheduler&gt;

Called by the harness when it needs to create a
L&lt;TAP::Parser::Scheduler&gt;. Override in a subclass to provide an
alternative scheduler. C&lt;make_scheduler&gt; is passed the list of tests
that was passed to C&lt;aggregate_tests&gt;.

=cut</pre></td></tr>
<tr><td class="h">766</td><td colspan="7"></td></tr><tr><td class="h">767</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub make_scheduler {</td></tr>
<tr><td class="h">768</td><td><div class="c3">79</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L768">79</a></div></td><td><div class="c3">1</div></td><td><div>97</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, @tests ) = @_;</td></tr>
<tr><td class="h">769</td><td><div class="c3">79</div></td><td></td><td></td><td></td><td></td><td><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;_construct(</td></tr>
<tr><td class="h">770</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;scheduler_class,</td></tr>
<tr><td class="h">771</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tests =&gt; [ $self-&gt;_add_descriptions(@tests) ],</td></tr>
<tr><td class="h">772</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules =&gt; $self-&gt;rules</td></tr>
<tr><td class="h">773</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">774</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">775</td><td colspan="7"></td></tr><tr><td class="h">776 - 782</td><td colspan="6"></td><td class="s"><pre>=head3 C&lt;jobs&gt;

Gets or sets the number of concurrent test runs the harness is
handling.&nbsp;&nbsp;By default, this value is 1 -- for parallel testing, this
should be set higher.

=cut</pre></td></tr>
<tr><td class="h">783</td><td colspan="7"></td></tr><tr><td class="h">784</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">##############################################################################</td></tr>
<tr><td class="h">785</td><td colspan="7"></td></tr><tr><td class="h">786</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _get_parser_args {</td></tr>
<tr><td class="h">787</td><td><div class="c3">107</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L787">107</a></div></td><td></td><td><div>118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $job ) = @_;</td></tr>
<tr><td class="h">788</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $test_prog = $job-&gt;filename;</td></tr>
<tr><td class="h">789</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>209</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %args&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ();</td></tr>
<tr><td class="h">790</td><td colspan="7"></td></tr><tr><td class="h">791</td><td><div class="c3">107</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L791">100</a></div></td><td></td><td></td><td></td><td><div>161</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$args{sources} = $self-&gt;sources if $self-&gt;sources;</td></tr>
<tr><td class="h">792</td><td colspan="7"></td></tr><tr><td class="h">793</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @switches;</td></tr>
<tr><td class="h">794</td><td><div class="c3">107</div></td><td><div class="c0" title="T/-"><a href="blib-lib-TAP-Harness-pm--branch.html#L794">50</a></div></td><td></td><td></td><td></td><td><div>162</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@switches = $self-&gt;lib if $self-&gt;lib;</td></tr>
<tr><td class="h">795</td><td><div class="c3">107</div></td><td><div class="c0" title="T/-"><a href="blib-lib-TAP-Harness-pm--branch.html#L795">50</a></div></td><td></td><td></td><td></td><td><div>110</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push @switches =&gt; $self-&gt;switches if $self-&gt;switches;</td></tr>
<tr><td class="h">796</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>146</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$args{switches}&nbsp;&nbsp;&nbsp;&nbsp;= \@switches;</td></tr>
<tr><td class="h">797</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>180</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$args{spool}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $self-&gt;_open_spool($test_prog);</td></tr>
<tr><td class="h">798</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>113</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$args{merge}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $self-&gt;merge;</td></tr>
<tr><td class="h">799</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$args{ignore_exit} = $self-&gt;ignore_exit;</td></tr>
<tr><td class="h">800</td><td><div class="c3">107</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L800">50</a></div></td><td></td><td></td><td></td><td><div>154</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$args{version}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= $self-&gt;version if $self-&gt;version;</td></tr>
<tr><td class="h">801</td><td colspan="7"></td></tr><tr><td class="h">802</td><td><div class="c3">107</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L802">100</a></div></td><td></td><td></td><td></td><td><div>121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( my $exec = $self-&gt;exec ) {</td></tr>
<tr><td class="h">803</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$args{exec}</td></tr>
<tr><td class="h">804</td><td><div class="c3">7</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L804">100</a></div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ref $exec eq &#39;CODE&#39;</td></tr>
<tr><td class="h">805</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $exec-&gt;( $self, $test_prog )</td></tr>
<tr><td class="h">806</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: [ @$exec, $test_prog ];</td></tr>
<tr><td class="h">807</td><td><div class="c3">7</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L807">100</a></div><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L807">100</a></div></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--condition.html#L807">100</a></div></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( not defined $args{exec} ) {</td></tr>
<tr><td class="h">808</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$args{source} = $test_prog;</td></tr>
<tr><td class="h">809</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">810</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elsif ( ( ref( $args{exec} ) || &quot;&quot; ) ne &quot;ARRAY&quot; ) {</td></tr>
<tr><td class="h">811</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$args{source} = delete $args{exec};</td></tr>
<tr><td class="h">812</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">813</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">814</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">815</td><td><div class="c3">100</div></td><td></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$args{source} = $test_prog;</td></tr>
<tr><td class="h">816</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">817</td><td colspan="7"></td></tr><tr><td class="h">818</td><td><div class="c3">107</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L818">100</a></div></td><td></td><td></td><td></td><td><div>119</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( defined( my $test_args = $self-&gt;test_args ) ) {</td></tr>
<tr><td class="h">819</td><td colspan="7"></td></tr><tr><td class="h">820</td><td><div class="c3">2</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L820">100</a></div></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ref($test_args) eq &#39;HASH&#39; ) {</td></tr>
<tr><td class="h">821</td><td colspan="7"></td></tr><tr><td class="h">822</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# different args for each test</td></tr>
<tr><td class="h">823</td><td><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="blib-lib-TAP-Harness-pm--branch.html#L823">50</a></div></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( exists( $test_args-&gt;{ $job-&gt;description } ) ) {</td></tr>
<tr><td class="h">824</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$test_args = $test_args-&gt;{ $job-&gt;description };</td></tr>
<tr><td class="h">825</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">826</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">827</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_croak( &quot;TAP::Harness Can&#39;t find test_args for &quot;</td></tr>
<tr><td class="h">828</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;. $job-&gt;description );</td></tr>
<tr><td class="h">829</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">830</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">831</td><td colspan="7"></td></tr><tr><td class="h">832</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$args{test_args} = $test_args;</td></tr>
<tr><td class="h">833</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">834</td><td colspan="7"></td></tr><tr><td class="h">835</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>158</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return \%args;</td></tr>
<tr><td class="h">836</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">837</td><td colspan="7"></td></tr><tr><td class="h">838 - 845</td><td colspan="6"></td><td class="s"><pre>=head3 C&lt;make_parser&gt;

Make a new parser and display formatter session. Typically used and/or
overridden in subclasses.

&nbsp;&nbsp;&nbsp;&nbsp;my ( $parser, $session ) = $harness-&gt;make_parser;

=cut</pre></td></tr>
<tr><td class="h">846</td><td colspan="7"></td></tr><tr><td class="h">847</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub make_parser {</td></tr>
<tr><td class="h">848</td><td><div class="c3">107</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L848">107</a></div></td><td><div class="c3">1</div></td><td><div>121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $job ) = @_;</td></tr>
<tr><td class="h">849</td><td colspan="7"></td></tr><tr><td class="h">850</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $args = $self-&gt;_get_parser_args($job);</td></tr>
<tr><td class="h">851</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_make_callback( &#39;parser_args&#39;, $args, $job-&gt;as_array_ref );</td></tr>
<tr><td class="h">852</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>187</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $parser = $self-&gt;_construct( $self-&gt;parser_class, $args );</td></tr>
<tr><td class="h">853</td><td colspan="7"></td></tr><tr><td class="h">854</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>489</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_make_callback( &#39;made_parser&#39;, $parser, $job-&gt;as_array_ref );</td></tr>
<tr><td class="h">855</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>425</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $session = $self-&gt;formatter-&gt;open_test( $job-&gt;description, $parser );</td></tr>
<tr><td class="h">856</td><td colspan="7"></td></tr><tr><td class="h">857</td><td><div class="c3">107</div></td><td></td><td></td><td></td><td></td><td><div>674</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ( $parser, $session );</td></tr>
<tr><td class="h">858</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">859</td><td colspan="7"></td></tr><tr><td class="h">860 - 865</td><td colspan="6"></td><td class="s"><pre>=head3 C&lt;finish_parser&gt;

Terminate use of a parser. Typically used and/or overridden in
subclasses. The parser isn&#39;t destroyed as a result of this.

=cut</pre></td></tr>
<tr><td class="h">866</td><td colspan="7"></td></tr><tr><td class="h">867</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub finish_parser {</td></tr>
<tr><td class="h">868</td><td><div class="c3">105</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L868">105</a></div></td><td><div class="c3">1</div></td><td><div>160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $parser, $session ) = @_;</td></tr>
<tr><td class="h">869</td><td colspan="7"></td></tr><tr><td class="h">870</td><td><div class="c3">105</div></td><td></td><td></td><td></td><td></td><td><div>241</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$session-&gt;close_test;</td></tr>
<tr><td class="h">871</td><td><div class="c3">105</div></td><td></td><td></td><td></td><td></td><td><div>521</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_close_spool($parser);</td></tr>
<tr><td class="h">872</td><td colspan="7"></td></tr><tr><td class="h">873</td><td><div class="c3">105</div></td><td></td><td></td><td></td><td></td><td><div>86</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $parser;</td></tr>
<tr><td class="h">874</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">875</td><td colspan="7"></td></tr><tr><td class="h">876</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _open_spool {</td></tr>
<tr><td class="h">877</td><td><div class="c3">108</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L877">108</a></div></td><td></td><td><div>43650</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">878</td><td><div class="c3">108</div></td><td></td><td></td><td></td><td></td><td><div>133</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $test = shift;</td></tr>
<tr><td class="h">879</td><td colspan="7"></td></tr><tr><td class="h">880</td><td><div class="c3">108</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L880">100</a></div></td><td></td><td></td><td></td><td><div>192</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( my $spool_dir = $ENV{PERL_TEST_HARNESS_DUMP_TAP} ) {</td></tr>
<tr><td class="h">881</td><td colspan="7"></td></tr><tr><td class="h">882</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $spool = File::Spec-&gt;catfile( $spool_dir, $test );</td></tr>
<tr><td class="h">883</td><td colspan="7"></td></tr><tr><td class="h">884</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Make the directory</td></tr>
<tr><td class="h">885</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ( $vol, $dir, undef ) = File::Spec-&gt;splitpath($spool);</td></tr>
<tr><td class="h">886</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $path = File::Spec-&gt;catpath( $vol, $dir, &#39;&#39; );</td></tr>
<tr><td class="h">887</td><td><div class="c3">2</div><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>1</div><div>239</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval { mkpath($path) };</td></tr>
<tr><td class="h">888</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L888">50</a></div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_croak($@) if $@;</td></tr>
<tr><td class="h">889</td><td colspan="7"></td></tr><tr><td class="h">890</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $spool_handle = IO::Handle-&gt;new;</td></tr>
<tr><td class="h">891</td><td><div class="c3">2</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L891">100</a></div></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open( $spool_handle, &quot;&gt;$spool&quot; )</td></tr>
<tr><td class="h">892</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $self-&gt;_croak(&quot; Can&#39;t write $spool ( $! ) &quot;);</td></tr>
<tr><td class="h">893</td><td colspan="7"></td></tr><tr><td class="h">894</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $spool_handle;</td></tr>
<tr><td class="h">895</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">896</td><td colspan="7"></td></tr><tr><td class="h">897</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>369</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">898</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">899</td><td colspan="7"></td></tr><tr><td class="h">900</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _close_spool {</td></tr>
<tr><td class="h">901</td><td><div class="c3">106</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L901">106</a></div></td><td></td><td><div>98</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">902</td><td><div class="c3">106</div></td><td></td><td></td><td></td><td></td><td><div>104</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($parser) = @_;</td></tr>
<tr><td class="h">903</td><td colspan="7"></td></tr><tr><td class="h">904</td><td><div class="c3">106</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L904">100</a></div></td><td></td><td></td><td></td><td><div>160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( my $spool_handle = $parser-&gt;delete_spool ) {</td></tr>
<tr><td class="h">905</td><td><div class="c3">2</div></td><td><div class="c3" title="T/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L905">100</a></div></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close($spool_handle)</td></tr>
<tr><td class="h">906</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or $self-&gt;_croak(&quot; Error closing TAP spool file( $! ) \n &quot;);</td></tr>
<tr><td class="h">907</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">908</td><td colspan="7"></td></tr><tr><td class="h">909</td><td><div class="c3">105</div></td><td></td><td></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">910</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">911</td><td colspan="7"></td></tr><tr><td class="h">912</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _croak {</td></tr>
<tr><td class="h">913</td><td><div class="c3">4</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-TAP-Harness-pm--subroutine.html#L913">4</a></div></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $self, $message ) = @_;</td></tr>
<tr><td class="h">914</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-TAP-Harness-pm--branch.html#L914">50</a></div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;unless ($message) {</td></tr>
<tr><td class="h">915</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$message = $self-&gt;_error;</td></tr>
<tr><td class="h">916</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">917</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;SUPER::_croak($message);</td></tr>
<tr><td class="h">918</td><td colspan="7"></td></tr><tr><td class="h">919</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">920</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">921</td><td colspan="7"></td></tr><tr><td class="h">922</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
<tr><td class="h">923</td><td colspan="7"></td></tr></table>
</body>
</html>
